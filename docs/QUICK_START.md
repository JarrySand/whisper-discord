# Discord 文字起こしBot - クイックスタートガイド

> ボイスチャンネルの会話を、話者識別付きでリアルタイム文字起こしするBotです。

---

## Botの概要

このBotは、Discordのボイスチャンネルでの会話を自動で文字起こしします。

**主な機能:**
- リアルタイム文字起こし（数秒の遅延で反映）
- 話者識別（誰が話したかを自動判定）
- 日本語に特化した高精度認識
- 過去の発言検索

---

## 初期設定（必須）

### 1. Botをサーバーに招待する

サーバー管理者から招待リンクを受け取り、Botをサーバーに追加してください。

### 2. APIキーを設定する

**文字起こしを使用するには、サーバー管理者がAPIキーを設定する必要があります。**

設定前に `/join` を実行すると、以下のエラーが表示されます：
```
❌ APIキーが設定されていません
```

**設定手順:**

1. APIキーを取得（以下のいずれか）:
   - **Groq（推奨）**: https://console.groq.com/ で無料アカウント作成
   - **OpenAI**: https://platform.openai.com/ でAPIキーを発行

2. サーバー管理者が設定コマンドを実行:
```
/apikey set provider:Groq api_key:gsk_xxxxx
```

3. 設定が完了すると、`/join` が使えるようになります

---

## 使い方

### 基本の流れ

```
1. ボイスチャンネルに参加
2. /join で Bot を呼ぶ
3. 会話する（自動で文字起こし）
4. /leave で終了
```

### ステップ詳細

#### Step 1: ボイスチャンネルに参加
まず自分がボイスチャンネルに接続してください。

#### Step 2: Botを呼ぶ
文字起こし結果を受け取りたいテキストチャンネルで `/join` を実行します。

```
/join
```

Botがボイスチャンネルに参加し、文字起こしが開始されます。

#### Step 3: 会話する
普通に会話するだけでOKです。文字起こし結果がテキストチャンネルに投稿されます。

**出力例:**
```
[14:23:15] Alice: こんにちは、今日の会議を始めましょう
[14:23:22] Bob: よろしくお願いします
```

#### Step 4: 終了する
```
/leave
```

Botが退出し、セッションが終了します。

---

## コマンド一覧

| コマンド | 説明 |
|---------|------|
| `/join` | Botをボイスチャンネルに参加させる |
| `/leave` | Botをボイスチャンネルから退出させる |
| `/status` | 現在の処理状況を確認 |
| `/search keyword:検索ワード` | 過去の発言を検索 |
| `/hotword` | 専門用語を登録して認識精度を向上 |

### /join
- 事前に自分がボイスチャンネルに接続している必要があります
- 文字起こし結果は `/join` を実行したチャンネルに投稿されます
- 出力チャンネルは自動で記憶されます

### /leave
- セッションを終了します
- ログファイルが保存されます

### /status
- 接続状態
- 処理した件数
- 成功率
- APIの状態

### /search
過去の発言をキーワードで検索できます。

```
/search keyword:議事録
/search keyword:予算 user:@Alice
```

| オプション | 説明 | 必須 |
|-----------|------|------|
| `keyword` | 検索キーワード | はい |
| `user` | ユーザーで絞り込み | いいえ |
| `limit` | 結果件数（最大50） | いいえ |

### /hotword
サーバーごとに専門用語（ホットワード）を登録できます。

```
/hotword add word:DAO
/hotword add word:NFT
/hotword list
/hotword remove word:DAO
```

| サブコマンド | 説明 |
|-------------|------|
| `add` | ホットワードを追加 |
| `list` | 登録済みのホットワードを一覧表示 |
| `remove` | ホットワードを削除 |
| `clear` | 全てのホットワードを削除 |

---

## 管理者向けコマンド

サーバー管理者のみ使用できるコマンドです。

### /apikey
サーバー専用のWhisper APIキーを設定します。

| サブコマンド | 説明 |
|-------------|------|
| `/apikey set` | APIキーを設定 |
| `/apikey clear` | APIキー設定を削除 |
| `/apikey status` | 現在の設定を確認 |
| `/apikey test` | APIキーの有効性をテスト |

**設定例:**
```
/apikey set provider:Groq api_key:gsk_xxxxx
/apikey set provider:OpenAI api_key:sk-xxxxx
/apikey set provider:Self-hosted url:http://localhost:8000
```

---

## Tips

### 相槌は自動除去されます
「うん」「はい」「なるほど」などの相槌は、ログに残りません。

### 専門用語の認識精度を上げるには
`/hotword add` で専門用語を登録すると、認識精度が向上します。

### 検索機能を使うには
サーバー管理者がSQLite機能を有効にしている必要があります。

---

## よくある質問

### Q: Botが参加しない
A: 自分がボイスチャンネルに接続しているか確認してください。

### Q: 文字起こしが遅い
A: 通常、発話から数秒〜10秒程度で反映されます。処理負荷によって変動します。

### Q: 認識精度が低い
A: マイクの音量を確認してください。また、`/hotword` で専門用語を登録すると精度が上がります。

### Q: 過去の検索ができない
A: `/search` コマンドはサーバー管理者がSQLite機能を有効にしている場合のみ使用できます。

---

## サポート

問題が発生した場合は、サーバー管理者にお問い合わせください。
