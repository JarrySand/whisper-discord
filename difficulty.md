ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã¸ã¨ã‚¹ã‚­ãƒƒãƒ—ã™ã‚‹
ãƒãƒ£ãƒƒãƒˆå±¥æ­´




ã“ã‚Œã¯ ChatGPT ã¨åŒ¿åã®åˆ©ç”¨è€…ã®é–“ã®ä¼šè©±ã®ã‚³ãƒ”ãƒ¼ã§ã™ã€‚

ä¼šè©±ã‚’å ±å‘Šã™ã‚‹
ã‚ãªãŸ:
discordã®voice chatã®è­°äº‹éŒ²ã‚’botã§ä½œã‚ŠãŸã„ã§ã™ã€‚
ä»Šã€seavoiceãŒã‚ã‚‹ã®ã§ã™ãŒã€ç²¾åº¦ãŒã¨ã¦ã‚‚æ‚ªã„ã§ã™ã€‚ã“ã®åŸå› ã‚’èª¿ã¹ã¦ãã ã•ã„ã€‚
ChatGPT:
äº†è§£ã—ã¾ã—ãŸã€‚ã¾ãšã¯ã€Œç²¾åº¦ãŒæ‚ªã„åŸå› ã€ã‚’ä½“ç³»çš„ã«ç‰¹å®šã™ã‚‹ã¨ã“ã‚ã‹ã‚‰å…¥ã‚Šã¾ã™ã­ã€‚
ã—ã‹ã—ã€éŸ³å£°è­°äº‹éŒ²Botã®ç²¾åº¦ä½ä¸‹ã¯è¤‡æ•°ã®è¦å› ãŒçµ¡ã‚€ã®ã§ã€ã„ãã¤ã‹ç¢ºèªè³ªå•ã‚‚ã•ã›ã¦ãã ã•ã„ã€‚

ä»¥ä¸‹ã§ã¯ Seavoiceï¼ˆã‚„é¡ä¼¼ã®Discord VCæ–‡å­—èµ·ã“ã—Botï¼‰ã§ç²¾åº¦ãŒæ‚ªããªã‚‹å…¸å‹åŸå›  ã‚’æ´—ã„å‡ºã—ã¤ã¤ã€ã©ã‚ŒãŒå½“ã¦ã¯ã¾ã‚Šãã†ã‹ã‚’ä¸€ç·’ã«çµã£ã¦ã„ãã¾ã™ã€‚

ğŸ” Seavoiceã®ç²¾åº¦ãŒæ‚ªã„ä¸»ãªåŸå› ï¼ˆç·è«–ï¼‰
Seavoiceã¯å®Ÿã¯ã€Œå›ºæœ‰ã®éŸ³å£°èªè­˜ãƒ¢ãƒ‡ãƒ«ã€ã‚’æŒã£ã¦ã„ã‚‹ã‚ã‘ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚
å¤šãã®å ´åˆã€

Whisperå°å‹ãƒ¢ãƒ‡ãƒ«

Google Speech APIï¼ˆæ—§å¼ï¼‰

ä½ã‚³ã‚¹ãƒˆSTTï¼ˆSpeech-to-Textï¼‰API

ã®ã©ã‚Œã‹ï¼ˆå»‰ä¾¡ãƒ¢ãƒ‡ãƒ«ï¼‰ã‚’ä½¿ã£ã¦ã„ã‚‹å¯èƒ½æ€§ãŒé«˜ãã€é«˜ç²¾åº¦ãƒ¢ãƒ‡ãƒ«ï¼ˆWhisper large-v3 / GPT-4o audio / OpenAI Realtime APIãªã©ï¼‰ãŒä½¿ã‚ã‚Œã¦ã„ãªã„ã‚±ãƒ¼ã‚¹ãŒå¤šã„ã§ã™ã€‚

ã•ã‚‰ã«Discordç‰¹æœ‰ã®è¦å› ã§ç²¾åº¦ãŒä¸‹ãŒã‚‹ã“ã¨ãŒå¤šã„ã€‚

ğŸ§ã€è¦å› â‘ ã€‘Discordã®VCéŸ³å£°ãŒâ€œåœ§ç¸®éŸ³å£°â€ã«ãªã£ã¦ã„ã‚‹
Discordã¯å¸¯åŸŸç¯€ç´„ã®ãŸã‚ã€ä»¥ä¸‹ã®ã‚ˆã†ã«éŸ³å£°ã‚’åœ§ç¸®ã—ã¦VCã¸æµã—ã¾ã™ï¼š

ã‚³ãƒ¼ãƒ‡ãƒƒã‚¯ï¼šOpus

ãƒ“ãƒƒãƒˆãƒ¬ãƒ¼ãƒˆï¼š16kbpsã€œ64kbpsï¼ˆã‚µãƒ¼ãƒãƒ¼ãƒ–ãƒ¼ã‚¹ãƒˆãƒ»è¨­å®šã«ä¾å­˜ï¼‰

é«˜åŸŸãŒæ¶ˆãˆã‚‹

ãƒã‚¤ã‚ºæˆåˆ†ãŒå¢—ãˆã‚‹

ãƒã‚¤ã‚¯åˆ‡ã‚Šæ›¿ãˆã§éŸ³å‰²ã‚ŒãŒèµ·ãã‚‹

â¡ STTãƒ¢ãƒ‡ãƒ«ãŒå¿…è¦ãªéŸ³å£°æƒ…å ±ãŒæ¬ è½ã—ã€ç²¾åº¦ãŒæ¿€æ¸›ã—ã¾ã™ã€‚

ç‰¹ã«ã€Œè¤‡æ•°äººã§è©±ã—ã¦ã„ã‚‹ã€ã€Œã‹ã¶ã‚Šã€ã€Œé€Ÿã„ä¼šè©±ã€ã§å´©å£Šã—ã¾ã™ã€‚

ğŸ™ã€è¦å› â‘¡ã€‘Botå´ãŒâ€œã‚¹ãƒ†ãƒ¬ã‚ªãƒŸãƒƒã‚¯ã‚¹â€ã§æ‹¾ã£ã¦ã„ãªã„
å¤šãã®DiscordéŒ²éŸ³Botã¯

Discordã®å†…éƒ¨éŸ³å£°ã‚¹ãƒˆãƒªãƒ¼ãƒ ã‚’ç›´æ¥å–å¾—ã§ãã¦ã„ãªã„
â†’ OutputãƒŸãƒƒã‚¯ã‚¹ã‚’å†ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã—ã¦ã„ã‚‹

ã¨ã„ã†æ§‹é€ ã«ãªã£ã¦ã„ã¾ã™ã€‚

ã“ã‚ŒãŒèµ·ãã‚‹ã¨â€¦

2å›åœ§ç¸®

ãƒã‚¤ã‚ºå¢—å¤§

å£°ã®é‡ãªã‚Šã‚’åˆ†é›¢ã§ããªã„

â¡ Whisper smallã‚¯ãƒ©ã‚¹ã®ãƒ¢ãƒ‡ãƒ«ã§ã¯çµ¶å¯¾ã«ã¤ã„ã¦ã„ã‘ãªã„ã§ã™ã€‚

ğŸ“‰ã€è¦å› â‘¢ã€‘STTãƒ¢ãƒ‡ãƒ«ãŒå°ã•ã„ï¼ˆWhisper small / tinyãªã©ï¼‰
ä½ä¾¡æ ¼ã®éŒ²éŸ³Botã¯ã»ã¼ç¢ºå®Ÿã«ä»¥ä¸‹ã®ã©ã‚Œã‹ï¼š

Whisper tiny

Whisper base

Google Speech-to-Textï¼ˆæ—§ç‰ˆï¼‰

ã‚‚ã—ãã¯ãƒ­ãƒ¼ã‚«ãƒ«ç‰ˆWhisper smallãªã©

ã“ã‚Œã‚‰ã¯ï¼š

æ–¹è¨€

å›ºæœ‰åè©

å°‚é–€ç”¨èªï¼ˆDAOã€NFTã€ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆåãªã©ï¼‰

åŒæ™‚ç™ºè©±

é›‘éŸ³

ã«å¼±ãã€è­°äº‹éŒ²ãƒ¬ãƒ™ãƒ«ã®ç²¾åº¦ã‚’ç¢ºä¿ã§ãã¾ã›ã‚“ã€‚

ç‰¹ã«ã‚ãªãŸã®ä¼šè©±ã¯ã€ŒDAOç”¨èªã€ã€Œåœ°åã€ã€Œãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆåã€ãªã©å›ºæœ‰åè©ãŒå¤šã„ã®ã§ã€å°å‹ãƒ¢ãƒ‡ãƒ«ã¯ã»ã¼é©ã—ã¦ã„ã¾ã›ã‚“ã€‚

ğŸ”Šã€è¦å› â‘£ã€‘è©±è€…è­˜åˆ¥ï¼ˆDiarizationï¼‰ãŒä¸åœ¨ or ç²¾åº¦ãŒä½ã„
Discordã¯è¤‡æ•°äººã§å–‹ã‚‹ãŸã‚

èª°ãŒè©±ã—ãŸã®ã‹

ç™ºè©±åŒºé–“ã‚’ã©ã†åˆ‡ã‚‹ã®ã‹

ãŒæ­£ç¢ºã§ãªã„ã¨å…¨æ–‡ãŒç ´ç¶»ã—ã¾ã™ã€‚

Seavoiceã¯è©±è€…è­˜åˆ¥ãŒå¼±ã„ï¼ˆã¾ãŸã¯ç„¡ã„ï¼‰å¯èƒ½æ€§ãŒé«˜ã„ã€‚

âš™ã€è¦å› â‘¤ã€‘Botã®å®Ÿè£…ãŒâ€œãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ å‡¦ç†â€ã§ã‚ã‚‹
ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ è­°äº‹éŒ²ã¯ä»¥ä¸‹ã®ç†ç”±ã§ç²¾åº¦ãŒä¸‹ãŒã‚Šã¾ã™ï¼š

ãƒ¢ãƒ‡ãƒ«ãŒä½é…å»¶ã‚¿ã‚¤ãƒ—ï¼ç²¾åº¦ã®ä½ã„ãƒ¢ãƒ‡ãƒ«

æ–‡è„ˆæƒ…å ±ã‚’ä¿æŒã§ããªã„

å¾Œå‡¦ç†ï¼ˆä¿®å¾©ãƒ»æ–‡æ³•æ•´å½¢ï¼‰ãŒç„¡ã„

é«˜ç²¾åº¦è­°äº‹éŒ²ã«ã¯æœ¬æ¥ï¼š

â‘ éŒ²éŸ³ â†’ â‘¡å…¨ä½“ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã‚’ãƒ¢ãƒ‡ãƒ«ã«æŠ•å…¥ â†’ â‘¢ä¸€æ‹¬å‡¦ç†

ãŒå¿…è¦ã§ã™ã€‚

ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ å¤‰æ›ã¯åŸºæœ¬çš„ã«èª¤å­—ãŒå¤šããªã‚Šã¾ã™ã€‚

ğŸ”§ã€è¦å› â‘¥ã€‘BotãŒãƒã‚¤ã‚¯ã”ã¨ã«éŸ³å£°ã‚’åˆ†é›¢ã§ãã¦ã„ãªã„
Discordã®éŒ²éŸ³Botã¯ã€å¤šããŒ ã€Œå…¨å“¡ã®å£°ã‚’ã²ã¨ã¤ã®ãƒŸãƒƒã‚¯ã‚¹éŸ³å£°ã€ ã§éŒ²éŸ³ã—ã¾ã™ã€‚

ï¼è¤‡æ•°äººãŒé‡ãªã‚‹ã¨å®Œå…¨ã«å´©å£Šã€‚

æœ¬å½“ã¯

ãƒ¦ãƒ¼ã‚¶ãƒ¼ã”ã¨ã®éŸ³å£°ãƒˆãƒ©ãƒƒã‚¯ã‚’å–å¾—ã™ã‚‹ï¼ˆDiscordã®Voice Receive APIï¼‰

Whisper large-v3 ä»¥ä¸Šã§åˆ†é›¢

ã®ã‚ˆã†ãªé«˜åº¦å‡¦ç†ãŒå¿…è¦ã§ã™ã€‚

ğŸ“Šã€è¦å› â‘¦ã€‘æ—¥æœ¬èªç‰¹æœ‰ã®å‡¦ç†ãŒè‹¦æ‰‹
Seavoiceã¯æµ·å¤–ãƒ—ãƒ­ãƒ€ã‚¯ãƒˆã§ã‚ã‚‹å¯èƒ½æ€§ãŒé«˜ãã€

æ—¥æœ¬èªãƒ¢ãƒ‡ãƒ«ã‚’ä½¿ã£ã¦ã„ãªã„

è‹±èªãƒ¢ãƒ‡ãƒ«ï¼‹è‡ªå‹•ç¿»è¨³ã®å¯èƒ½æ€§

é–“æŠ•è©ï¼ˆã‚ãƒ¼ã€ãˆãƒ¼ã¨ï¼‰ã«å¼±ã„

ã“ã®ã›ã„ã§ç²¾åº¦ãŒã•ã‚‰ã«è½ã¡ã¾ã™ã€‚

ğŸ‘€ã“ã“ã‹ã‚‰æ­£ç¢ºã«åŸå› ã‚’çµã‚‹ãŸã‚ã®è³ªå•
ç²¾åº¦ä½ä¸‹ã®åŸå› ã¯ã²ã¨ã¤ã§ã¯ãªã çµ„ã¿åˆã‚ã› ãªã®ã§ã€ä¸‹è¨˜ã‚’æ•™ãˆã¦ã„ãŸã ã‘ã‚‹ã¨ã€ã©ã“ã‹ã‚‰æ”¹å–„ã™ã¹ãã‹æ˜ç¢ºã«ãªã‚Šã¾ã™ã€‚

â“è³ªå•1
Seavoiceã¯ã€ŒDiscordã®ã©ã®éŸ³å£°ã‚½ãƒ¼ã‚¹ã€ã‚’åˆ©ç”¨ã—ã¦è­°äº‹éŒ²ã‚’ä½œã£ã¦ã„ã¾ã™ã‹ï¼Ÿ

ã‚³ã‚¢APIï¼ˆDiscord Voice Receiveï¼‰

Botç”¨ã®å¤–éƒ¨Recorder

ç”»é¢å…±æœ‰éŸ³å£°

OBSçµŒç”± etc.

â€»ã‚ãªãŸãŒæŠŠæ¡ã—ã¦ã„ãªã‘ã‚Œã°ã€èª¿ã¹æ–¹ã‚’æ¡ˆå†…ã—ã¾ã™ã€‚

â“è³ªå•2
å‡ºã¦ãã‚‹èª¤å­—ã®ç¨®é¡ã¯ã©ã‚Œã«è¿‘ã„ã§ã™ã‹ï¼Ÿ

A. æ–‡ç« ãŒæˆç«‹ã—ãªã„ï¼ˆå˜èªè‡ªä½“ãŒé–“é•ã†ï¼‰

B. æ–‡æ³•ã¯æ•´ã£ã¦ã„ã‚‹ãŒå°‚é–€ç”¨èªãŒå´©ã‚Œã‚‹

C. ç‰¹å®šã®å£°ï¼ˆä¾‹ï¼šé«˜ã„å£°ã€æ—©å£ï¼‰ãŒç‰¹ã«èª¤å­—ã«ãªã‚‹

D. è©±è€…ãŒè­˜åˆ¥ã•ã‚Œã¦ã„ãªã„

E. å…¨ä½“çš„ã«ãƒã‚¤ã‚ºã®ã‚ˆã†ãªæ–‡ã«ã—ã‹ãªã‚‰ãªã„

ã©ã‚Œã«è¿‘ã„ã§ã—ã‚‡ã†ã‹ï¼Ÿ

â“è³ªå•3
é€šè©±ã¯ä½•åã§è¡Œã£ã¦ã„ã¾ã™ã‹ï¼Ÿ
ã¾ãŸã€åŒæ™‚ã«è©±ã™å ´é¢ã¯å¤šã„ã§ã™ã‹ï¼Ÿ

â“è³ªå•4
Discordã‚µãƒ¼ãƒãƒ¼ã®éŸ³è³ªè¨­å®šã¯ï¼Ÿ

éŸ³å£°ãƒ“ãƒƒãƒˆãƒ¬ãƒ¼ãƒˆï¼ˆ64kbpsï¼Ÿ 96ï¼Ÿ 128ï¼Ÿï¼‰

ã‚µãƒ¼ãƒãƒ¼ãƒ–ãƒ¼ã‚¹ãƒˆã®æœ‰ç„¡

ã‚¨ã‚³ãƒ¼é™¤å»ãƒ»ãƒã‚¤ã‚ºæŠ‘åˆ¶ã®è¨­å®š

â“è³ªå•5
éŒ²éŸ³ã¯ã€Œä¼šè©±éŒ²éŸ³ã¨ã—ã¦ã®å“è³ªã€ã§ååˆ†ã§ã™ã‹ï¼Ÿ
ãã‚Œã¨ã‚‚ã€Œã»ã¼å®Œç’§ãªè­°äº‹éŒ²ã€ãŒå¿…è¦ã§ã™ã‹ï¼Ÿ

æ±‚ã‚ã‚‹ç²¾åº¦ãƒ¬ãƒ™ãƒ«ã«ã‚ˆã£ã¦ã€æ¨å¥¨æ§‹æˆãŒã¾ã£ãŸãå¤‰ã‚ã‚Šã¾ã™ã€‚

âœ¨ã¾ãšã¯ã“ã“ã‚’æ•™ãˆã¦ãã ã•ã„
è³ªå•1ã€œ5 ã®å›ç­”ã‚’ã„ãŸã ã‘ã‚Œã°ã€æ­£ç¢ºã«åŸå› ã‚’åˆ‡ã‚Šåˆ†ã‘ã¦ã€
ã‚ãªãŸã®DAOä¼šè­°ã«æœ€é©ãªã€Œé«˜ç²¾åº¦è­°äº‹éŒ²Botã®è¨­è¨ˆå›³ã€ã¾ã§ä½œã‚Œã¾ã™ã€‚

å¿…è¦ã§ã‚ã‚Œã°ã€

Discord VC â†’ ãƒãƒ«ãƒãƒˆãƒ©ãƒƒã‚¯éŒ²éŸ³

Whisper large-v3 / GPT-4o audioã®é«˜ç²¾åº¦å¤‰æ›

è©±è€…è­˜åˆ¥

è­°äº‹éŒ²è‡ªå‹•æ•´å½¢

BotåŒ–ï¼ˆPython / Node.jsï¼‰

ã¾ã§ã€å®Œå…¨ã«ã‚«ã‚¹ã‚¿ãƒ ã—ãŸè­°äº‹éŒ²Botã®è¦ä»¶å®šç¾©ãƒ»ã‚³ãƒ¼ãƒ‰ã‚‚ä½œã‚Œã¾ã™ã€‚

ã¾ãšã€ã©ã‚ŒãŒå½“ã¦ã¯ã¾ã‚Šãã†ã‹æ•™ãˆã¦ãã ã•ã„ã€‚

ã‚ãªãŸ:
discordã«å…¥åŠ›ã—ãŸéŸ³å£°ã‚’ãã®ã¾ã¾æ‹¾ã£ã¦ã€å€‹äººè­˜åˆ¥ã—ãªãŒã‚‰ã€è­°äº‹éŒ²ã«ã¾ã¨ã‚ã‚‹ã¨ã„ã†ã®ã¯æ§‹é€ ä¸Šé›£ã—ã„ã®ã§ã—ã‚‡ã†ã‹
ChatGPT:

æ€è€ƒå®Œäº†
çµè«–ã‹ã‚‰è¨€ã†ã¨ã€

ã€Œdiscordã«å…¥åŠ›ã—ãŸéŸ³å£°ã‚’ãã®ã¾ã¾æ‹¾ã£ã¦ã€è©±è€…ã”ã¨ã«åˆ†ã‘ã¦ã€**ãã‚Œã„ãªè­°äº‹éŒ²ã«ã¾ã¨ã‚ã‚‹ã€ã“ã¨ã¯ã€
æŠ€è¡“çš„ã«ã¯å¯èƒ½ã ãŒã€ã‹ãªã‚Šâ€œé›£æ˜“åº¦é«˜ã‚ã®ç·åˆæ ¼é—˜æŠ€â€ ã§ã™ã€‚

ã€Œæ§‹é€ ä¸Šãƒ ãƒªã€ã§ã¯ãªã„ã‘ã©ã€ã€Œã¡ã‚ƒã‚“ã¨ã‚„ã‚ã†ã¨ã™ã‚‹ã¨ã€ã‹ãªã‚Šä½œã‚Šè¾¼ã¾ãªã„ã¨ãƒ€ãƒ¡ã€ã¨ã„ã†æ„Ÿã˜ã§ã™ã€‚

1ï¸âƒ£ ã¾ãšã€Discordå´ã¯ä½•ãŒã§ãã‚‹ã®ã‹ï¼Ÿ
Discordã®Voice APIè‡ªä½“ã¯ã€

VCã®éŸ³å£°ã‚’ ãƒ¦ãƒ¼ã‚¶ãƒ¼ã”ã¨ã®ã‚¹ãƒˆãƒªãƒ¼ãƒ ã¨ã—ã¦å—ä¿¡ ã§ãã‚‹

èª°ãŒå–‹ã£ã¦ã„ã‚‹ã‹ã®IDã‚‚å–ã‚Œã‚‹

ãªã®ã§ã€ã€Œå€‹äººè­˜åˆ¥ã—ãªãŒã‚‰éŒ²éŸ³ã™ã‚‹ã€ã¯ æ§‹é€ çš„ã«ã¯å¯èƒ½

ã§ã™ã€‚

ãŸã ã—ã€ã“ã“ã§çµ‚ã‚ã‚‰ãªã„ã®ãŒåœ°ç„ãƒã‚¤ãƒ³ãƒˆã§ã€

éŸ³å£°ã¯åœ§ç¸®ã•ã‚ŒãŸOpus

ãƒãƒƒãƒˆã®ãƒ©ã‚°ãƒ»ãƒ‘ã‚±ãƒƒãƒˆãƒ­ã‚¹ã‚ã‚Š

è¤‡æ•°äººãŒåŒæ™‚ã«è©±ã™

ãã‚Œã‚’ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã§å‡¦ç†ã—ãŸã„

ã¿ãŸã„ãªæ¡ä»¶ãŒä¸¦ã¶ã®ã§ã€éŸ³å£°èªè­˜ãƒ¢ãƒ‡ãƒ«å´ã«ã‹ãªã‚Šè² è·ãŒã‹ã‹ã‚‹ã“ã¨ã«ãªã‚Šã¾ã™ã€‚

2ï¸âƒ£ ã€Œè©±è€…ã”ã¨ã«æ–‡å­—èµ·ã“ã—ã€ã¯ã©ã“ãŒé›£ã—ã„ã®ã‹ï¼Ÿ
âœ… æŠ€è¡“çš„ã«ã§ãã‚‹ã“ã¨
æ§‹æˆã¨ã—ã¦ã¯ï¼š

Discordã®Voice Receiveã§

user_idã”ã¨ã«éŸ³å£°ã‚¹ãƒˆãƒªãƒ¼ãƒ ã‚’å—ã‘å–ã‚‹

ãã‚Œã‚’PCM/WAVã«å¾©å·

ã²ã¨ã‚Šãšã¤Whisperç­‰ã«æŠ•ã’ã¦æ–‡å­—èµ·ã“ã—

ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—ã‚’è¦‹ã¦ã€Œä¼šè­°ã®ã‚¿ã‚¤ãƒ ãƒ©ã‚¤ãƒ³ã€ã«å†æ§‹æˆ

ã“ã“ã¾ã§ã¯è¨­è¨ˆã¨ã—ã¦ã¯ç´ ç›´ã§ã™ã€‚

ğŸ˜… ã§ã‚‚ã€ç¾å®Ÿã®é›£ã—ã•
äººãŒã‹ã¶ã£ã¦è©±ã™ã¨ã€èªè­˜ãƒ¢ãƒ‡ãƒ«ãŒä¸€æ°—ã«æ··ä¹±

ã€Œãˆã£ã¨ã€ã€Œã‚ã€ãã†ãã†ã€ã€Œã‚ãƒ¼ã€ã¿ãŸã„ãªç›¸æ§Œãƒ»åˆã„ã®æ‰‹ãŒå¤§é‡

ç›¸æ§Œã‚‚å…¨éƒ¨ãƒ†ã‚­ã‚¹ãƒˆã«ãªã‚‹ â†’ è­°äº‹éŒ²ã¨ã—ã¦ã¯ãƒã‚¤ã‚ºã ã‚‰ã‘

1æ™‚é–“Ã—5äººåˆ†ã®éŸ³å£°ã‚’å…¨éƒ¨Whisper largeã§å›ã™ã¨è¨ˆç®—ã‚³ã‚¹ãƒˆãŒé‡ã„

ï¼ã€Œå€‹äººã”ã¨ã®ç”Ÿãƒ­ã‚°ã€ã¯ä½œã‚Œã¦ã‚‚ã€â€œèª­ã¿ã‚„ã™ã„è­°äº‹éŒ²â€ã¾ã§è‡ªå‹•ã§æŒã£ã¦ã„ãã®ãŒé›£ã—ã„ã€ã¨ã„ã†æ§‹é€ ã§ã™ã€‚

3ï¸âƒ£ ã€Œè­°äº‹éŒ²ã«ã¾ã¨ã‚ã‚‹ã€ãŒå®Ÿã¯ä¸€ç•ªã‚€ãšã„
ã€Œæ–‡å­—èµ·ã“ã—ã€ã‚ˆã‚Šé›£ã—ã„ã®ã¯ã€ãã®å¾Œã®ã€Œè­°äº‹éŒ²åŒ–ã€ã§ã™ã€‚

æ©Ÿæ¢°ãŒã‚„ã‚‹ã¨ã€ã ã„ãŸã„ã“ã†ãªã‚‹
é›‘è«‡ã¨æœ¬é¡Œã®åŒºåˆ¥ãŒã¤ã‹ãªã„

çµè«–ï¼è«–ç‚¹ï¼æ±ºå®šäº‹é …ï¼TODO ã®åˆ‡ã‚Šåˆ†ã‘ãŒã§ããªã„

æ–‡è„ˆã‚’ç†è§£ã—ã¦ã€Œè¦ç´„ã€ã™ã‚‹å¿…è¦ãŒã‚ã‚‹

èª°ãŒä½•ã«åŒæ„ã—ãŸã‹ã‚’è¿½ã†å¿…è¦ãŒã‚ã‚‹

ã“ã‚Œã¯ç´”ç²‹ãªSTTã§ã¯ãªãã€LLMå´ã®ä»•äº‹ã«ãªã‚Šã¾ã™ã€‚

ãŸã¨ãˆã°æ§‹æˆã¯ã“ã‚“ãªã‚¤ãƒ¡ãƒ¼ã‚¸ï¼š

VCçµ‚äº†å¾Œã«ã€Œå…¨ç™ºè¨€ãƒ­ã‚°ï¼ˆè©±è€…IDä»˜ãï¼‰ã€ã‚’ä½œã‚‹

ãã‚Œã‚’LLMã«æŠ•ã’ã¦ï¼š

è­°é¡Œã”ã¨ã«æ•´ç†

æ±ºå®šäº‹é …ãƒ»TODOãƒ»ä¿ç•™äº‹é …ã«åˆ†é¡

äººã”ã¨ã®ç™ºè¨€è¦ç´„

æœ€çµ‚çš„ãª Markdownã®è­°äº‹éŒ² ã‚’ç”Ÿæˆ

ã“ã“ã¾ã§ã‚„ã‚Œã°ã€Œäººé–“ãŒæ‰‹ç›´ã—ã™ã‚Œã°ä½¿ãˆã‚‹ãƒ¬ãƒ™ãƒ«ã€ã«ãªã‚Šã¾ã™ãŒã€
ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã§ã‚­ãƒ¬ã‚¤ãªè­°äº‹éŒ²ã‚’å‡ºã™ã®ã¯ã»ã¼ä¸å¯èƒ½ã«è¿‘ã„ã§ã™ã€‚

âœ… ç¾å®Ÿè§£ï¼š

ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã¯ã€Œã–ã£ãã‚Šå­—å¹•ã€ç¨‹åº¦

æœ¬æ°—ã®è­°äº‹éŒ²ã¯ã€Œä¼šè­°å¾Œã«ã¾ã¨ã‚ã¦å‡¦ç†ã€

ã¨ã„ã†äºŒæ®µæ§‹ãˆã«ã™ã‚‹ã®ãŒä¸€ç•ªç¾å®Ÿçš„ã§ã™ã€‚

4ï¸âƒ£ ã€Œæ§‹é€ ä¸Šã®ãƒœãƒˆãƒ«ãƒãƒƒã‚¯ã€ã¯ã“ã“
ã‚ãªãŸã®è³ªå•ã«ã‚¬ãƒã§ç­”ãˆã‚‹ã¨ã€æ§‹é€ ä¸Šã®é›£æ‰€ã¯ã ã„ãŸã„ã“ã®3ã¤ã§ã™ï¼š

åœ§ç¸®ï¼†ãƒã‚¤ã‚ºã®å¤šã„DiscordéŸ³å£°

ã‚¯ãƒªã‚¢ãªZooméŒ²ç”»ã‚ˆã‚Šèªè­˜ç²¾åº¦ãŒè½ã¡ã‚„ã™ã„

è¤‡æ•°äººåŒæ™‚ç™ºè©±ï¼‹ç›¸æ§Œã¾ã¿ã‚Œ

è©±è€…åˆ†é›¢ã¨é‡è¦åº¦åˆ¤æ–­ãŒå¿…é ˆ

è­°äº‹éŒ²ã¨ã—ã¦ã®æ•´ç†åŠ›

ãŸã ã®ãƒ†ã‚­ã‚¹ãƒˆã§ã¯ãªãã€æ§‹é€ åŒ–ã•ã‚ŒãŸã‚¢ã‚¦ãƒˆãƒ—ãƒƒãƒˆãŒå¿…è¦

ï¼ã€Œé›£ã—ã„ã®ã¯Discordå´ã®ä»•æ§˜ã¨ã„ã†ã‚ˆã‚Šã€äººé–“ã®ä¼šè©±ã‚’â€œãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆâ€ã«å¤‰æ›ã™ã‚‹ã¨ã“ã‚ã€ã§ã™ã€‚

5ï¸âƒ£ ã˜ã‚ƒã‚ã€ã©ã†è¨­è¨ˆã™ã‚Œã°ã€Œç¾å®Ÿçš„ã«ã€å®Ÿè£…ã§ãã‚‹ï¼Ÿ
ã–ã£ãã‚Šè¨€ã†ã¨ã€æ¬¡ã®ã‚ˆã†ãªå‰²ã‚Šåˆ‡ã‚ŠãŒå…¥ã‚‹ã¨ä¸€æ°—ã«ç¾å®Ÿçš„ã«ãªã‚Šã¾ã™ï¼š

ğŸ”Š éŒ²éŸ³ã¯ãƒ¦ãƒ¼ã‚¶ãƒ¼ã”ã¨ï¼†é«˜ãƒ“ãƒƒãƒˆãƒ¬ãƒ¼ãƒˆã§å–ã‚‹

Discordã®Voice APIã§user_idã”ã¨ã®éŸ³å£°ã‚’å–ã‚‹

ã‚µãƒ¼ãƒãƒ¼å´ã§Opusâ†’PCMå¤‰æ›

ğŸ§  æ–‡å­—èµ·ã“ã—ã¯ä¼šè­°å¾Œã«ä¸€æ‹¬å‡¦ç†

Whisper large-v3 or OpenAI audioãƒ¢ãƒ‡ãƒ«

ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã§ã¯ã€Œã–ã£ãã‚Šå­—å¹•ã€ã ã‘ã«ã™ã‚‹

ğŸ‘¥ è©±è€…ã”ã¨ãƒ­ã‚° ï¼‹ å…¨ä½“ã‚¿ã‚¤ãƒ ãƒ©ã‚¤ãƒ³ã§ä¿å­˜

timestamp, speaker, text ã®å½¢ã§DBä¿å­˜

ğŸ“„ è­°äº‹éŒ²ç”Ÿæˆã¯LLMã§å¾Œå‡¦ç†

ã€Œã“ã®ä¼šè­°ã®è­°äº‹éŒ²ã‚’ä½œã£ã¦ã€‚ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã¯â€¦ã€ã¨ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆå›ºå®š

æ±ºå®šäº‹é …/TODO/è«–ç‚¹ã‚’è‡ªå‹•æŠ½å‡º

ğŸ§¹ æœ€å¾Œã¯äººé–“ãŒ5ã€œ10åˆ†ã ã‘ãƒã‚§ãƒƒã‚¯ã—ã¦ç¢ºå®šç‰ˆã«ã™ã‚‹

ã“ã“ã¾ã§ã‚„ã‚‹ã¨ã€

ã€Œäººé–“ãŒã‚¼ãƒ­ã‹ã‚‰è­°äº‹éŒ²ã‚’æ›¸ãã€ã¨æ¯”ã¹ã¦ 8ã€œ9å‰²ãã‚‰ã„ã®åŠ´åŠ›å‰Šæ¸› ã¯ç¾å®Ÿçš„ã«ç‹™ãˆã¾ã™ã€‚

6ï¸âƒ£ ã‚ãªãŸã®ä½¿ã„æ–¹ã‚’å‰æã«ã—ãŸã¨ãã®ç­”ãˆ
DAOã®è­°è«–

å›ºæœ‰åè©ãƒ»ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆåãŒå¤šã„

ãƒ¡ãƒ³ãƒãƒ¼ã‚‚æ—©å£ãƒ»æŠ½è±¡è«–ãƒ»å°‚é–€ç”¨èªå¤šã‚

ã¨ã„ã†å‰æã§è¨€ã†ã¨ï¼š

ã€Œdiscordã®éŸ³å£°ã‚’ãã®ã¾ã¾æ‹¾ã£ã¦ã€å€‹äººè­˜åˆ¥ä»˜ãã§â€œã¡ã‚ƒã‚“ã¨ã—ãŸè­°äº‹éŒ²â€ã‚’è‡ªå‹•ç”Ÿæˆã™ã‚‹ã€ã®ã¯ã€æ§‹é€ ä¸Šã‹ãªã‚Šé›£ã—ã„ï¼ˆï¼ç´ ã®Botã§ã¯ã¾ãšç„¡ç†ï¼‰ã€‚
ãŸã ã—ã€

VCå¾Œã«ã¾ã¨ã‚ã¦é«˜æ€§èƒ½ãƒ¢ãƒ‡ãƒ«ã§å‡¦ç†

è©±è€…ä»˜ããƒ­ã‚° â†’ LLMã§è­°äº‹éŒ²åŒ–
ã¨ã„ã†äºŒæ®µæ§‹æˆã«ã™ã‚Œã°ã€ååˆ†å®Ÿç”¨ãƒ¬ãƒ™ãƒ«ã«æŒã£ã¦ã„ã‘ã‚‹ã€ã¨ã„ã†ã®ãŒç¾å®Ÿè§£ã§ã™ã€‚

7ï¸âƒ£ æ¬¡ã«ä¸€ç·’ã«æ±ºã‚ãŸã„ã“ã¨
ã“ã“ã‹ã‚‰è¨­è¨ˆã«è½ã¨ã—è¾¼ã‚€ãªã‚‰ã€ã¾ãšã¯ã“ã“ã‚’èã‹ã›ã¦ã»ã—ã„ã§ã™ï¼š

Q. ã‚ãªãŸãŒæ¬²ã—ã„ã€Œè­°äº‹éŒ²ã€ã®ç†æƒ³å½¢ã¯ã©ã‚Œã«è¿‘ã„ã§ã™ã‹ï¼Ÿ

A. ã»ã¼å…¨æ–‡ã€‚ã‚ã¨ã§æ¤œç´¢ã§ãã‚Œã°ã„ã„
B. æ±ºå®šäº‹é …ãƒ»TODOãƒ»è«–ç‚¹ã ã‘æ‹¾ãˆã‚Œã°ã„ã„
C. ç™»å£‡è€…ï¼ä¸»å‚¬è€…ã®ç™ºè¨€ã ã‘ã‚­ãƒ¬ã‚¤ã«æ®‹ã—ãŸã„
D. æŠ•è³‡å®¶ãƒ»è¡Œæ”¿ã«å‡ºã›ã‚‹ãƒ¬ãƒ™ãƒ«ã® â€œå…¬å¼è­°äº‹éŒ²â€ ãŒæ¬²ã—ã„

ã©ã®ãƒ¬ãƒ™ãƒ«ã‚’ã‚´ãƒ¼ãƒ«ã«ã™ã‚‹ã‹ã§ã€

ä½¿ã†ãƒ¢ãƒ‡ãƒ«

Botã®æ§‹æˆ

ã‚³ã‚¹ãƒˆæ„Ÿ
å…¨éƒ¨å¤‰ã‚ã£ã¦ãã¾ã™ã€‚

ã©ã®ã‚¤ãƒ¡ãƒ¼ã‚¸ãŒè¿‘ã„ã‹æ•™ãˆã¦ã‚‚ã‚‰ãˆã‚Œã°ã€
ã€ŒDiscordè­°äº‹éŒ²Botã®è¨­è¨ˆå›³ï¼ˆæ§‹æˆï¼‹å¿…è¦æŠ€è¡“ï¼‹ã–ã£ãã‚Šå·¥æ•°ï¼‰ã€ ã¾ã§ä¸€æ°—ã«æãã¾ã™ã€‚

ã‚ãªãŸ:
ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ€§ã¯ä¸è¦ã§ã™ã€‚
ã¾ãŸã€è­°äº‹éŒ²åŒ–ã™ã‚‹å¿…è¦ã‚‚ãªã„ã§ã™ã€‚ã‚ã¨ã§æ¤œç´¢ã§ãã‚Œã°ã„ã„ã§ã™ã€‚
ã¾ãŸã€ç›¸æ§Œç³»ã‚’å‰Šé™¤ã—ã¦ã‚‚ã‚‰ã£ã¦å¤§ä¸ˆå¤«ã§ã™ã€‚
ChatGPT:

æ€è€ƒå®Œäº†

æ€è€ƒå®Œäº†

æ€è€ƒæ™‚é–“: 47s
ãã®æ¡ä»¶ãªã‚‰ã€ã‹ãªã‚Šã€Œç¾å®Ÿçš„ã§ä½œã‚Šã‚„ã™ã„ã€ã§ã™ ğŸ‘

âœ… ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ä¸è¦

âœ… è­°äº‹éŒ²åŒ–ï¼ˆè¦ç´„ãƒ»æ§‹é€ åŒ–ï¼‰ã‚‚ä¸è¦

âœ… ã‚ã¨ã§æ¤œç´¢ã§ãã‚Œã°OK

âœ… ç›¸æ§Œã¯æ¶ˆã—ã¦ã‚ˆã„

ã®ã§ã€ã€Œç²¾åº¦é‡è¦–ã®â€œéŒ²éŸ³ï¼‹å¾Œå‡¦ç†â€å‹ãƒœãƒƒãƒˆã€ã‚’çµ„ã‚ã°ã€Seavoiceã‚ˆã‚Šã ã„ã¶ãƒã‚·ãªã‚‚ã®ãŒç‹™ãˆã¾ã™ã€‚

1. ã–ã£ãã‚Šæ§‹æˆã‚¤ãƒ¡ãƒ¼ã‚¸
ã‚´ãƒ¼ãƒ«ï¼š

VCã®éŸ³å£°ã‚’ãƒ¦ãƒ¼ã‚¶ãƒ¼ã”ã¨ã«éŒ²éŸ³ â†’ ä¼šè­°çµ‚äº†å¾Œã«ã¾ã¨ã‚ã¦é«˜ç²¾åº¦STT â†’
ç›¸æ§Œã‚’å‰Šã£ã¦DBã«ä¿å­˜ â†’ Discordã‹ã‚‰å…¨æ–‡æ¤œç´¢ã§ãã‚‹

ã¨ã„ã†ãƒ•ãƒ­ãƒ¼ã§ã™ã€‚

â‘  Discordã§ã®éŒ²éŸ³éƒ¨åˆ†
Bot ã« /record start ã¿ãŸã„ãªã‚³ãƒãƒ³ãƒ‰ã‚’æŠ•ã’ã¦VCã«å‚åŠ ã•ã›ã‚‹

Discordã® Voice Receive API ã§
ã€Œèª°ï¼ˆuser_idï¼‰ãŒã€ã„ã¤ã€ã©ã®éŸ³å£°ã‚’å‡ºã—ãŸã‹ã€ ã‚’ã‚¹ãƒˆãƒªãƒ¼ãƒ ã¨ã—ã¦å–å¾—

å„ãƒ¦ãƒ¼ã‚¶ãƒ¼ã”ã¨ã« Opus â†’ PCM/WAV ã«å¤‰æ›ã—ã¦ãƒ•ã‚¡ã‚¤ãƒ«ä¿å­˜
ï¼ˆãƒ­ãƒ¼ã‚«ãƒ« or S3 ãªã©ï¼‰

â€» Voice Receive ã¯ã€æ—¢å­˜ã®Whisperé€£æºBotã§ã‚‚ä½¿ã‚ã‚Œã¦ã„ã¾ã™ï¼ˆä¾‹ï¼šdiscospeech, V.O.L.O ãªã©ï¼‰ã€‚

â‘¡ ä¼šè­°çµ‚äº†å¾Œã«ã¾ã¨ã‚ã¦æ–‡å­—èµ·ã“ã—
ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã§ã¯ãªãã€Œå¾Œã‹ã‚‰ä¸€æ‹¬ã€ã§OKãªã®ã§ã€
Whisper large-v3 ã‚¯ãƒ©ã‚¹ï¼‹GPU ã‚’ä½¿ã†ã¨ã‹ãªã‚Šç²¾åº¦ãŒä¸ŠãŒã‚Šã¾ã™ã€‚

å®Ÿè£…ä¾‹ã¨ã—ã¦ã€faster-whisper large-v3 ã§Discordä¼šè­°ã‚’æ–‡å­—èµ·ã“ã—ã—ã¦ã„ã‚‹ä¾‹ã‚‚ã‚ã‚Šã¾ã™ã€‚

è¨€èªã‚’ ja ã«å›ºå®šã—ã€hotwords ã«ã€ŒDAOåãƒ»ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆåã€ãªã©ã‚’å°‘ã—ã ã‘ç™»éŒ²ã™ã‚‹ã¨ã€å°‚é–€ç”¨èªã®ç²¾åº¦ã‚‚ä¸ŠãŒã‚Šã¾ã™ã€‚

å‡¦ç†ã®æµã‚Œï¼š

ã€Œä¼šè­°ã‚»ãƒƒã‚·ãƒ§ãƒ³ã€ãŒçµ‚ã‚ã£ãŸã“ã¨ã‚’ãƒˆãƒªã‚¬ãƒ¼

ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰ã‚¸ãƒ§ãƒ–ï¼ˆWorkerï¼‰ãŒéŒ²éŸ³ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ‹¾ã†

ãƒ¦ãƒ¼ã‚¶ãƒ¼åˆ¥ã« STT ã‚’å›ã™

timestamp / speaker / text ã®å½¢ã§ JSON or DB ã«ä¿å­˜

â‘¢ ç›¸æ§Œã‚’æ©Ÿæ¢°çš„ã«å‰Šã‚‹
å®Œå…¨è‡ªå‹•ãªã‚‰ã€ãƒ«ãƒ¼ãƒ«ãƒ™ãƒ¼ã‚¹ã§ååˆ†ã§ã™ã€‚

å¯¾è±¡ä¾‹ï¼š

ã€Œã†ã‚“ã€ã€Œã¯ã„ã€ã€Œã‚ãƒ¼ã€ã€Œãˆãƒ¼ã¨ã€ã€Œãã†ã§ã™ã­ã€ã€Œãªã‚‹ã»ã©ã€ã€Œãƒã‚¸ã§ã€

3ã€œ5æ–‡å­—ç¨‹åº¦ã§çµ‚ã‚ã‚‹çŸ­ã„æ–‡

å‡¦ç†ä¾‹ï¼š

æ–‡å­—æ•°ãŒçŸ­ã„ & ä¸Šè¨˜ã®ãƒ•ãƒ¬ãƒ¼ã‚ºã ã‘ â†’ å‰Šé™¤

ã€Œã‚ãƒ¼ã€ãã‚Œã§ã•ã€ã®ã‚ˆã†ã«æ··ã–ã£ã¦ã„ã‚‹å ´åˆã¯æ®‹ã™

ã‚‚ã£ã¨çœŸé¢ç›®ã«ã‚„ã‚‹ãªã‚‰ï¼š

MeCab ãªã©ã§å“è©è§£æã—ã¦ã€Œæ„Ÿå‹•è©ã ã‘ã®æ–‡ã€ã‚’å‰Šã‚‹
â†’ ã»ã¼ç›¸æ§Œã ã‘æ¶ˆãˆã¦ã€æœ¬ç­‹ã®ç™ºè¨€ã¯æ®‹ã‚‹

â‘£ æ¤œç´¢ç”¨ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸
è­°äº‹éŒ²åŒ–ã¯ä¸è¦ã¨ã®ã“ã¨ãªã®ã§ã€ãƒ•ãƒ«ãƒ†ã‚­ã‚¹ãƒˆæ¤œç´¢ã«å¯„ã›ã‚‹æ§‹æˆã§è‰¯ã•ãã†ã§ã™ã€‚

æœ€ä½ãƒ©ã‚¤ãƒ³ï¼š

PostgreSQL + tsvectorï¼ˆã¾ãŸã¯ MySQL ã® FULLTEXTï¼‰

ãƒ†ãƒ¼ãƒ–ãƒ«ä¾‹ï¼š

meetings(id, guild_id, channel_id, started_at, ended_at, title...)

utterances(id, meeting_id, speaker_discord_id, started_at, text)

ã¡ã‚‡ã£ã¨ã¡ã‚ƒã‚“ã¨ã‚„ã‚‹ãªã‚‰ï¼š

Meilisearch / Typesense / OpenSearch ãªã©ã®å…¨æ–‡æ¤œç´¢ã‚¨ãƒ³ã‚¸ãƒ³

ã•ã‚‰ã«ä½™è£•ãŒã‚ã‚Œã°ã€text-embedding ã§ãƒ™ã‚¯ãƒˆãƒ«æ¤œç´¢ã‚‚è¿½åŠ 
â†’ ã€Œãƒ‹ãƒ¥ã‚¢ãƒ³ã‚¹æ¤œç´¢ã€ã§ãã‚‹ã‚ˆã†ã«ãªã‚‹

â‘¤ Discordã‹ã‚‰ã®åˆ©ç”¨ã‚¤ãƒ¡ãƒ¼ã‚¸
ä¾‹ï¼‰

/search keyword: "ç¤¾å“¡æ¨© DAO åˆåŒä¼šç¤¾"
â†’ Bot ãŒã€Œä¼šè­°ä¸€è¦§ï¼‹ç™ºè¨€æŠœç²‹ã€ã‚’è¿”ã™

/search user: @sawa keyword: "KIBOTCHA"
â†’ è‡ªåˆ†ï¼ˆã¾ãŸã¯ç‰¹å®šãƒ¦ãƒ¼ã‚¶ãƒ¼ï¼‰ã®ç™ºè¨€ã ã‘ã«çµã£ã¦è¡¨ç¤º

/search meeting: 2025-11-10
â†’ ç‰¹å®šæ—¥ä»˜ã®ä¼šè­°ãƒ­ã‚°ã‚’ä¸€è¦§è¡¨ç¤º

é‡è¦ãƒã‚¤ãƒ³ãƒˆï¼š
ã€Œå…¨æ–‡ï¼‹è©±è€…IDï¼‹ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—ã€ãŒæƒã£ã¦ã„ã‚Œã°ã€
å¾Œã‹ã‚‰ã„ãã‚‰ã§ã‚‚ã€Œè­°äº‹éŒ²ã£ã½ãã¾ã¨ã‚ã‚‹ã€ã€Œç‰¹å®šä¼šè­°ã‚’èª­ã¿ç›´ã™ã€ãªã©ã«ç™ºå±•ã§ãã¾ã™ã€‚

2. ãªãœSeavoiceã§ç²¾åº¦ãŒå‡ºã«ãã„ã‹ï¼ˆã‚ãªãŸã®è¦ä»¶ã¨ã®ã‚®ãƒ£ãƒƒãƒ—ï¼‰
Seavoiceã¯ã€

ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ STT ã‚’ä¸»ç”¨é€”ã«ã—ã¦ã„ã‚‹ï¼ˆVCä¸­ã«å­—å¹•ã‚’å‡ºã™ãªã©ï¼‰

å¤šè¨€èªå¯¾å¿œãƒ»æ±ç”¨ç”¨é€”å‘ã‘ï¼ˆæ—¥æœ¬èªç‰¹åŒ–ã§ã¯ãªã„ï¼‰

ã¨ã„ã†æ€§è³ªãŒå¼·ã„ã®ã§ã€

é«˜ç²¾åº¦ãƒ¢ãƒ‡ãƒ«ã‚’é•·æ™‚é–“å›ã™å‰æã§ã¯ãªã„

æ—¥æœ¬èªï¼‹DAOç”¨èªï¼‹è¤‡æ•°äººåŒæ™‚ç™ºè©± ã¿ãŸã„ãªãƒ‹ãƒƒãƒæ¡ä»¶ã«ã¯æœ€é©åŒ–ã•ã‚Œã¦ã„ãªã„

ï¼ã€Œã‚ãªãŸã®è¦ä»¶ï¼ˆãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ä¸è¦ãƒ»æ¤œç´¢ç”¨ã«ç²¾åº¦é‡è¦–ï¼‰ã¨ã¯ã€ãã‚‚ãã‚‚è¨­è¨ˆæ€æƒ³ãŒé•ã†ã€ã®ãŒæ ¹æœ¬è¦å› ã ã¨æ€ã„ã¾ã™ã€‚

3. ã“ã“ã‹ã‚‰å…·ä½“è¨­è¨ˆã«è½ã¨ã™ãŸã‚ã®ç¢ºèª
ã“ã¡ã‚‰å´ã§è¦ä»¶å®šç¾©æ–‡æ›¸ã¾ã§ä¸€æ°—ã«ä½œã‚‹ã¨ã—ãŸã‚‰ã€ã‚ã¨ä»¥ä¸‹ã ã‘æ±ºã‚ãŸã„ã§ã™ï¼š

é–‹ç™ºè¨€èªã®å¸Œæœ›ã¯ã‚ã‚Šã¾ã™ã‹ï¼Ÿ

Pythonï¼ˆãƒ©ã‚¤ãƒ–ãƒ©ãƒªè±Šå¯Œã€faster-whisperã¨ç›¸æ€§â—ï¼‰

Node.jsï¼ˆdiscord.jsã§Botå‘¨ã‚ŠãŒæ›¸ãã‚„ã™ã„ï¼‰

STTã¯ã©ã¡ã‚‰ãŒã‚ˆã•ãã†ã§ã™ã‹ï¼Ÿ

A. è‡ªå‰GPU or ã‚¯ãƒ©ã‚¦ãƒ‰GPUã§ faster-whisper large-v3 ã‚’å›ã™ï¼ˆãƒ©ãƒ³ãƒ‹ãƒ³ã‚°ã‚³ã‚¹ãƒˆæŠ‘ãˆã‚ãƒ»æ§‹ç¯‰é‡ã‚ï¼‰

B. OpenAIç­‰ã® ã‚¯ãƒ©ã‚¦ãƒ‰STT APIã‚’ä½¿ã†ï¼ˆæ§‹ç¯‰ç°¡å˜ãƒ»å¾“é‡èª²é‡‘ï¼‰

ãƒ­ã‚°ã®ä¿ç®¡å…ˆã®æƒ³å®š

æ—¢å­˜ã§ä½¿ã£ã¦ã„ã‚‹DBï¼ˆä¾‹ï¼šPostgreSQLï¼‰

Notion / Slack / Google Drive é€£æºã—ãŸã„ ãªã©

ã“ã‚ŒãŒæ±ºã¾ã‚Œã°ã€

å…¨ä½“ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£å›³

å…·ä½“çš„ãªãƒ†ãƒ¼ãƒ–ãƒ«è¨­è¨ˆ

å‡¦ç†ãƒ•ãƒ­ãƒ¼ï¼ˆæ“¬ä¼¼ã‚³ãƒ¼ãƒ‰ or ç–‘ä¼¼APIï¼‰

ã€Œclaude / ä»–ãƒ¢ãƒ‡ãƒ«ã«æŠ•ã’ã‚‹ãŸã‚ã®ä»•æ§˜ãƒ†ã‚­ã‚¹ãƒˆã€

ã¾ã§ã“ã¡ã‚‰ã§çµ„ã¿ç«‹ã¦ã¾ã™ã€‚

ã¾ãšã¯

â‘ è¨€èªï¼ˆPython / Nodeï¼‰
â‘¡STTæ–¹å¼ï¼ˆè‡ªå‰GPU or APIï¼‰

ã“ã®2ã¤ã€ã©ã¡ã‚‰å¯„ã‚ŠãŒã‚ˆã•ãã†ã‹æ•™ãˆã¦ã‚‚ã‚‰ãˆã¾ã™ã‹ï¼Ÿ

ã‚ãªãŸ:
Pythonã§ãŠé¡˜ã„è‡´ã—ã¾ã™ã€‚
ChatGPT:

æ€è€ƒå®Œäº†

æ€è€ƒæ™‚é–“: 27s
Pythonå‰æãªã‚‰ã€ã‹ãªã‚Šç¶ºéº—ã«è¨­è¨ˆã§ãã¾ã™ã€‚
ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ å­—å¹•ã‚‚è¦ã‚‰ãšã€ã€Œã‚ã¨ã§æ¤œç´¢ã§ãã‚‹ãƒ­ã‚°ã€ãŒã‚´ãƒ¼ãƒ«ãªã®ã§ã€éŒ²éŸ³ â†’ å¾Œå‡¦ç† â†’ æ¤œç´¢ã«å‰²ã‚Šåˆ‡ã£ãŸæ§‹æˆã«ã—ã¾ã—ã‚‡ã†ã€‚

å…¨ä½“åƒï¼š3ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆæ§‹æˆ
Recorder Botï¼ˆDiscordä¸Šã§å‹•ãPythonã®Botï¼‰

VCã«å‚åŠ ã—ã¦ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã”ã¨ã«éŸ³å£°ã‚’éŒ²éŸ³

meeting_id / user_id / timestamp ã‚’ä»˜ã‘ã¦éŸ³å£°ãƒ•ã‚¡ã‚¤ãƒ«ä¿å­˜ï¼ˆWAVãªã©ï¼‰

Transcriberï¼ˆå¾Œå‡¦ç†ã‚¹ã‚¯ãƒªãƒ—ãƒˆï¼‰

éŒ²éŸ³ãŒçµ‚ã‚ã£ãŸä¼šè­°ã®éŸ³å£°ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã¾ã¨ã‚ã¦å‡¦ç†

Whisper large-v3ç­‰ã§æ–‡å­—èµ·ã“ã—

ç›¸æ§Œã£ã½ã„ç™ºè©±ã‚’å‰Šé™¤

utterancesãƒ†ãƒ¼ãƒ–ãƒ«ï¼ˆDBï¼‰ã«ä¿å­˜

æ¤œç´¢ã‚¤ãƒ³ã‚¿ãƒ•ã‚§ãƒ¼ã‚¹

/search ã‚³ãƒãƒ³ãƒ‰ã‚„CLIã‹ã‚‰

ã€Œã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ï¼‹è©±è€…ï¼‹æ—¥ä»˜ã€ãªã©ã§å…¨æ–‡æ¤œç´¢

è­°äº‹éŒ²åŒ–ã¯ã—ãªã„ï¼ˆç”Ÿãƒ­ã‚°ã¨ã—ã¦èª­ã‚€ï¼‰

1. ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«ï¼ˆæœ€ä½é™ï¼‰
SQLiteã‚„PostgreSQLã‚’æƒ³å®šã—ã¾ã™ï¼ˆä»¥ä¸‹ã¯æ¦‚å¿µï¼‰ã€‚

meetings ãƒ†ãƒ¼ãƒ–ãƒ«
CREATE TABLE meetings (
  id TEXT PRIMARY KEY,                -- UUIDãªã©
  guild_id TEXT NOT NULL,
  channel_id TEXT NOT NULL,
  started_at DATETIME NOT NULL,
  ended_at DATETIME,
  title TEXT
);
utterances ãƒ†ãƒ¼ãƒ–ãƒ«
CREATE TABLE utterances (
  id INTEGER PRIMARY KEY AUTOINCREMENT,
  meeting_id TEXT NOT NULL,
  speaker_id TEXT NOT NULL,          -- Discordã®user_id
  started_at REAL NOT NULL,          -- ä¼šè­°é–‹å§‹ã‹ã‚‰ã®ç§’æ•°
  text TEXT NOT NULL
);
æ¤œç´¢ã—ãŸã„ã ã‘ãªã‚‰ã€ã“ã®2ãƒ†ãƒ¼ãƒ–ãƒ«ã§ååˆ†ã§ã™ã€‚

2. Recorder Botï¼ˆPythonãƒ»ç–‘ä¼¼ã‚³ãƒ¼ãƒ‰ï¼‰
Discordã®éŸ³å£°å—ä¿¡ã¯å®Ÿè£…ãŒã¡ã‚‡ã£ã¨ã‚¯ã‚»ãŒã‚ã‚‹ã®ã§ã€ã€Œã‚„ã‚ŠãŸã„ã“ã¨ãŒä¼ã‚ã‚‹ãƒ¬ãƒ™ãƒ«ã€ã®ã‚³ãƒ¼ãƒ‰ã«ã—ã¦ãŠãã¾ã™ã€‚
å®Ÿè£…ãã®ã‚‚ã®ã¯ã€ã“ã®ä»•æ§˜ã‚’å…ƒã«Claudeç­‰ã«è‚‰ä»˜ã‘ã•ã›ã‚‹ã®ãŒç¾å®Ÿçš„ã§ã™ã€‚

å¿…è¦ãƒ©ã‚¤ãƒ–ãƒ©ãƒªï¼ˆä¾‹ï¼‰
discord.pyï¼ˆã¾ãŸã¯ py-cord / disnake ç­‰ã€éŸ³å£°å—ä¿¡ã«å¯¾å¿œã—ã¦ã„ã‚‹ãƒ•ã‚©ãƒ¼ã‚¯ï¼‰

opuslib / PyNaCl ãªã©ï¼ˆéŸ³å£°ãƒ‡ã‚³ãƒ¼ãƒ‰ç”¨ï¼‰

Botã®ã–ã£ãã‚Šãƒ•ãƒ­ãƒ¼
import discord
import asyncio
import uuid
from datetime import datetime

TOKEN = "YOUR_DISCORD_BOT_TOKEN"

intents = discord.Intents.default()
intents.message_content = True
intents.voice_states = True

bot = discord.Client(intents=intents)

# ä¼šè­°ã”ã¨ã®ãƒ¡ã‚¿æƒ…å ±
current_sessions = {}  # key: guild_id, value: MeetingSession


class MeetingSession:
    def __init__(self, guild_id, channel_id):
        self.id = str(uuid.uuid4())
        self.guild_id = guild_id
        self.channel_id = channel_id
        self.started_at = datetime.utcnow()
        self.voice_client = None
        # ãƒ¦ãƒ¼ã‚¶ãƒ¼ã”ã¨ã®éŒ²éŸ³ãƒãƒƒãƒ•ã‚¡
        self.user_buffers = {}  # user_id -> bytearray

    def add_audio(self, user_id, pcm_data: bytes):
        if user_id not in self.user_buffers:
            self.user_buffers[user_id] = bytearray()
        self.user_buffers[user_id].extend(pcm_data)

    async def save_recordings(self):
        # ä¼šè­°çµ‚äº†æ™‚ã«ãƒ¦ãƒ¼ã‚¶ãƒ¼ã”ã¨ã«WAVä¿å­˜ã™ã‚‹å‡¦ç†ã‚’æ›¸ã
        for user_id, buffer in self.user_buffers.items():
            filename = f"recordings/{self.id}_{user_id}.wav"
            save_pcm_to_wav(buffer, filename)


def save_pcm_to_wav(pcm_bytes: bytearray, filename: str):
    import wave
    # Discordã¯48kHz, 16bit, monoãŒå¤šã„æƒ³å®š
    with wave.open(filename, "wb") as wf:
        wf.setnchannels(1)
        wf.setsampwidth(2)
        wf.setframerate(48000)
        wf.writeframes(pcm_bytes)
ã“ã“ã«ã€å®Ÿéš›ã®**éŸ³å£°å—ä¿¡ï¼ˆOpusâ†’PCMãƒ‡ã‚³ãƒ¼ãƒ‰ï¼‰**ã®ãƒ­ã‚¸ãƒƒã‚¯ã‚’å·®ã—è¾¼ã‚€å½¢ã«ãªã‚Šã¾ã™ã€‚

discord.VoiceClient ã«ã‚«ã‚¹ã‚¿ãƒ  AudioSink ã‚’ä»˜ã‘ã¦ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã”ã¨ã®PCMã‚’å—ä¿¡

å—ä¿¡ã—ãŸPCMã‚’ session.add_audio(user_id, pcm_data) ã«æ¸¡ã™

ã“ã®éƒ¨åˆ†ã¯ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã”ã¨ã«æ›¸ãæ–¹ãŒé•ã†ã®ã§ã€

ã€ŒDiscord Python voice receive ã§ user ã”ã¨ã«éŸ³å£°ã‚’éŒ²éŸ³ã™ã‚‹AudioSinkã‚’å®Ÿè£…ã—ã¦ã€

ã¨ã„ã†æŒ‡ç¤ºã‚’ã€ã“ã®ã‚³ãƒ¼ãƒ‰ã¨ä¸€ç·’ã«Claudeãªã©ã«æŠ•ã’ã‚‹ã®ãŒä¸€ç•ªæ—©ã„ã§ã™ã€‚

ä¼šè­°é–‹å§‹ãƒ»çµ‚äº†ã‚³ãƒãƒ³ãƒ‰ä¾‹ï¼ˆslashã§ãªãprefixã§ã‚·ãƒ³ãƒ—ãƒ«ã«ï¼‰
from discord.ext import commands

bot = commands.Bot(command_prefix="!", intents=intents)

@bot.command()
async def record(ctx):
    """VCéŒ²éŸ³é–‹å§‹ã‚³ãƒãƒ³ãƒ‰: !record"""
    voice_channel = ctx.author.voice.channel
    if not voice_channel:
        await ctx.send("ã¾ãšãƒœã‚¤ã‚¹ãƒãƒ£ãƒ³ãƒãƒ«ã«å‚åŠ ã—ã¦ãã ã•ã„ã€‚")
        return

    voice_client = await voice_channel.connect()
    session = MeetingSession(ctx.guild.id, voice_channel.id)
    session.voice_client = voice_client

    current_sessions[ctx.guild.id] = session

    # ã“ã“ã§ AudioSink ã‚’ã‚»ãƒƒãƒˆã—ã¦éŒ²éŸ³é–‹å§‹
    # voice_client.start_recording(MySink(session), finished_callback, ctx.channel)

    await ctx.send(f"éŒ²éŸ³ã‚’é–‹å§‹ã—ã¾ã—ãŸã€‚ï¼ˆmeeting_id: {session.id}ï¼‰")


@bot.command()
async def stop(ctx):
    """VCéŒ²éŸ³çµ‚äº†ã‚³ãƒãƒ³ãƒ‰: !stop"""
    session = current_sessions.get(ctx.guild.id)
    if not session:
        await ctx.send("éŒ²éŸ³ã‚»ãƒƒã‚·ãƒ§ãƒ³ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã€‚")
        return

    # éŒ²éŸ³åœæ­¢
    # session.voice_client.stop_recording()
    await session.save_recordings()
    await session.voice_client.disconnect()

    del current_sessions[ctx.guild.id]
    await ctx.send("éŒ²éŸ³ã‚’çµ‚äº†ã—ã€ãƒ•ã‚¡ã‚¤ãƒ«ä¿å­˜ã—ã¾ã—ãŸã€‚")
3. Transcriberï¼ˆæ–‡å­—èµ·ã“ã—ï¼‹ç›¸æ§Œå‰Šé™¤ï¼‰
éŒ²éŸ³ãƒ•ã‚¡ã‚¤ãƒ«ãŒ recordings/meetingId_userId.wav ã«æºœã¾ã£ã¦ã„ã‚‹å‰æã§ã€
Whisper large-v3ï¼ˆfaster-whisperï¼‰ã§ã¾ã¨ã‚ã¦æ–‡å­—èµ·ã“ã—ã™ã‚‹ä¾‹ã§ã™ã€‚

from faster_whisper import WhisperModel
import sqlite3
import glob
import os
import re
from datetime import datetime

DB_PATH = "logs.db"

# å¤§ãã‚ã®ãƒ¢ãƒ‡ãƒ«ã‚’ä½¿ã†ï¼ˆGPUãŒãªã‘ã‚Œã° "medium" ãªã©ã«è½ã¨ã™ï¼‰
model = WhisperModel("large-v3", device="cuda", compute_type="float16")

# ç›¸æ§Œã¨ã¿ãªã™ãƒ‘ã‚¿ãƒ¼ãƒ³ï¼ˆå¿…è¦ã«å¿œã˜ã¦æ‹¡å¼µï¼‰
AIZUCHI_PATTERNS = [
    r"^ã†ã‚“[ã€‚]*$",
    r"^ã¯ã„[ã€‚]*$",
    r"^ãˆãƒ¼ã¨[ã€‚]*$",
    r"^ã‚ãƒ¼[ã€‚]*$",
    r"^ãã†ã§ã™ã­[ã€‚]*$",
    r"^ãªã‚‹ã»ã©[ã€‚]*$",
]

aizuchi_regex = re.compile("|".join(AIZUCHI_PATTERNS))


def is_aizuchi(text: str) -> bool:
    t = text.strip()
    # çŸ­ã„ç›¸æ§Œã£ã½ã„æ–‡ã ã‘ã‚’å‰Šã‚‹
    if len(t) > 15:
        return False
    return bool(aizuchi_regex.match(t))


def init_db():
    conn = sqlite3.connect(DB_PATH)
    cur = conn.cursor()
    cur.execute("""
    CREATE TABLE IF NOT EXISTS meetings (
      id TEXT PRIMARY KEY,
      guild_id TEXT,
      channel_id TEXT,
      started_at TEXT,
      ended_at TEXT,
      title TEXT
    );
    """)
    cur.execute("""
    CREATE TABLE IF NOT EXISTS utterances (
      id INTEGER PRIMARY KEY AUTOINCREMENT,
      meeting_id TEXT NOT NULL,
      speaker_id TEXT NOT NULL,
      started_at REAL NOT NULL,
      text TEXT NOT NULL
    );
    """)
    conn.commit()
    conn.close()


def transcribe_meeting(meeting_id: str):
    """
    recordings/{meeting_id}_{user_id}.wav ã‚’å…¨éƒ¨ãªã‚ã¦DBã«æ›¸ãè¾¼ã‚€
    """
    conn = sqlite3.connect(DB_PATH)
    cur = conn.cursor()

    pattern = f"recordings/{meeting_id}_*.wav"
    for path in glob.glob(pattern):
        filename = os.path.basename(path)
        # ãƒ•ã‚¡ã‚¤ãƒ«åã‹ã‚‰ user_id ã‚’æŠ½å‡º
        # ä¾‹:  <meeting_id>_<user_id>.wav
        user_id = filename.replace(f"{meeting_id}_", "").replace(".wav", "")

        segments, info = model.transcribe(
            path,
            language="ja",
            vad_filter=True
        )

        for seg in segments:
            text = seg.text.strip()
            if not text:
                continue
            if is_aizuchi(text):
                continue  # ç›¸æ§Œã¯ä¿å­˜ã—ãªã„

            cur.execute("""
            INSERT INTO utterances (meeting_id, speaker_id, started_at, text)
            VALUES (?, ?, ?, ?)
            """, (meeting_id, user_id, float(seg.start), text))

    conn.commit()
    conn.close()
vad_filter=True ã§ç„¡éŸ³ã‚„ãƒã‚¤ã‚ºã‚’ã‚ã‚‹ç¨‹åº¦ã‚«ãƒƒãƒˆ

is_aizuchi() ã§ç›¸æ§Œã‚‰ã—ã„çŸ­æ–‡ã ã‘é™¤å¤–

4. ã‚·ãƒ³ãƒ—ãƒ«æ¤œç´¢ã‚¹ã‚¯ãƒªãƒ—ãƒˆä¾‹
ã‚ã¨ã§CLIã‚„Discordã‚³ãƒãƒ³ãƒ‰ã‹ã‚‰å‘¼ã¹ã‚‹ã‚ˆã†ãªå…¨æ–‡æ¤œç´¢ã®è¶…ã‚·ãƒ³ãƒ—ãƒ«ç‰ˆã§ã™ã€‚

import sqlite3

DB_PATH = "logs.db"

def search(keyword: str, speaker_id: str | None = None):
    conn = sqlite3.connect(DB_PATH)
    cur = conn.cursor()

    sql = """
    SELECT meeting_id, speaker_id, started_at, text
    FROM utterances
    WHERE text LIKE ?
    """
    params = [f"%{keyword}%"]

    if speaker_id:
        sql += " AND speaker_id = ?"
        params.append(speaker_id)

    sql += " ORDER BY meeting_id, started_at"

    for row in cur.execute(sql, params):
        meeting_id, speaker, started_at, text = row
        print(f"[{meeting_id}][{speaker}][{started_at:6.1f}s] {text}")

    conn.close()


if __name__ == "__main__":
    kw = input("æ¤œç´¢ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰: ")
    search(kw)
ã“ã‚Œã‚’ã•ã‚‰ã«ç™ºå±•ã•ã›ã¦ã€

Discordã® /search keyword: "xxx" ã‚³ãƒãƒ³ãƒ‰ã‹ã‚‰å‘¼ã¶

çµæœã‚’åŸ‹ã‚è¾¼ã¿ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã§è¿”ã™

ã¨ã„ã†å½¢ã«ã™ã‚Œã°ã€ã€Œã©ã®ä¼šè­°ã®ã€èª°ã®ã€ã©ã®ç™ºè¨€ã‹ã€ ã‚’Discordä¸Šã‹ã‚‰ã™ãã«å¼•ã‘ã¾ã™ã€‚

5. ã¾ã¨ã‚ã‚‹ã¨
ã‚ãªãŸã®è¦ä»¶ï¼š

âœ… ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ€§ä¸è¦

âœ… è­°äº‹éŒ²åŒ–ï¼ˆè¦ç´„ï¼‰ã¯ä¸è¦

âœ… å¾Œã‹ã‚‰å…¨æ–‡æ¤œç´¢ã§ãã‚Œã°ã‚ˆã„

âœ… ç›¸æ§Œã¯å‰Šé™¤ã—ã¦OK

ã«å¯¾ã—ã¦ã¯ã€

ã€ŒDiscord Botã§ user ã”ã¨ã«éŒ²éŸ³ â†’ Whisper large-v3 ç­‰ã§å¾Œå‡¦ç† â†’ ç›¸æ§Œå‰Šé™¤ â†’ SQLite/PostgreSQLã«ä¿å­˜ â†’ ã‚·ãƒ³ãƒ—ãƒ«å…¨æ–‡æ¤œç´¢ã€

ã¨ã„ã†å½¢ãŒã€ä¸€ç•ªã‚³ã‚¹ãƒ‘ã®è‰¯ã„è§£ã§ã™ã€‚

æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—ã®ææ¡ˆ
ã“ã“ã‹ã‚‰é€²ã‚ã‚‹ãªã‚‰ï¼š

ã¾ãš Transcriberï¼‹æ¤œç´¢ã‚¹ã‚¯ãƒªãƒ—ãƒˆ ã‚’ãƒ­ãƒ¼ã‚«ãƒ«éŸ³å£°ã§è©¦ã™
â†’ ã€Œç²¾åº¦ã€ã¨ã€Œç›¸æ§Œå‰Šé™¤ã®å…·åˆã€ã‚’ç¢ºèªã™ã‚‹

å•é¡Œãªã‘ã‚Œã°ã€Recorder Botéƒ¨åˆ†ã‚’Claudeç­‰ã«ã“ã®ä»•æ§˜ã¨ä¸€ç·’ã«æŠ•ã’ã¦ã€

AudioSinkå®Ÿè£…

userã”ã¨ã®PCMã‚¹ãƒˆãƒªãƒ¼ãƒ ä¿å­˜
ã‚’ä»•ä¸Šã’ã¦ã‚‚ã‚‰ã†

ã¨ã„ã†æµã‚ŒãŒä¸€ç•ªã‚¹ãƒ ãƒ¼ã‚ºã ã¨æ€ã„ã¾ã™ã€‚

ã“ã“ã¾ã§èª­ã‚“ã§ã¿ã¦ã€

å…ˆã«ã€Œãƒ­ãƒ¼ã‚«ãƒ«éŸ³å£°ãƒ•ã‚¡ã‚¤ãƒ« â†’ æ–‡å­—èµ·ã“ã—ï¼‹æ¤œç´¢ã€ã®éƒ¨åˆ†ã‹ã‚‰çµ„ã‚€ã‹

ã„ããªã‚ŠDiscord Botéƒ¨åˆ†ã‹ã‚‰æ”»ã‚ã‚‹ã‹

ã©ã£ã¡ã‹ã‚‰ç€æ‰‹ã—ãŸã„æ„Ÿè¦šã«è¿‘ã„ã§ã™ã‹ï¼Ÿ
ãã‚Œã«åˆã‚ã›ã¦ã€ã‚‚ã†å°‘ã—æ‰‹é †ã‚’ç´°ã‹ãåˆ†è§£ã—ã¦ã„ãã¾ã—ã‚‡ã†ã€‚

ã‚ãªãŸ:
å‰è€…ã§ãŠé¡˜ã„è‡´ã—ã¾ã™ã€‚
ChatGPT:

æ€è€ƒæ™‚é–“: 13s
OKã€ã˜ã‚ƒã‚ã¾ãšã¯

ãƒ­ãƒ¼ã‚«ãƒ«ã®éŸ³å£°ãƒ•ã‚¡ã‚¤ãƒ« â†’ æ–‡å­—èµ·ã“ã— â†’ ç›¸æ§Œå‰Šé™¤ â†’ DBä¿å­˜ â†’ æ¤œç´¢

ã¾ã§ã‚’ã€Pythonã ã‘ã§å®Œçµã™ã‚‹ãƒŸãƒ‹ç’°å¢ƒã¨ã—ã¦ä½œã‚‹å½¢ã§ã„ãã¾ã™ã€‚

æœ€çµ‚çš„ã« Discord Bot ã‹ã‚‰ã‚‚åŒã˜DBæ§‹é€ ã‚’ä½¿ã„å›ã›ã‚‹ã‚ˆã†ã«ã—ã¦ãŠãã¾ã™ã€‚

â‘  å…¨ä½“æ§‹æˆï¼ˆãƒ­ãƒ¼ã‚«ãƒ«æ¤œè¨¼ç”¨ï¼‰
ã“ã‚“ãªæ„Ÿã˜ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’æƒ³å®šã—ã¾ã™ï¼š

project/
  recordings/
    sample1.wav      # ã‚ãªãŸãŒè©¦ã—ã«éŒ²éŸ³ã—ãŸãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç½®ã
  db/
    logs.db          # è‡ªå‹•ç”Ÿæˆã•ã‚Œã‚‹SQLite
  transcribe_local.py
  search_cli.py
transcribe_local.py
â†’ 1ãƒ•ã‚¡ã‚¤ãƒ«ã‚’Whisperã§æ–‡å­—èµ·ã“ã—ã—ã¦DBã«ä¿å­˜ï¼ˆç›¸æ§Œå‰Šé™¤è¾¼ã¿ï¼‰

search_cli.py
â†’ ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã§å…¨æ–‡æ¤œç´¢ã—ã¦çµæœã‚’è¡¨ç¤º

â‘¡ å¿…è¦ãªãƒ©ã‚¤ãƒ–ãƒ©ãƒª
pip install faster-whisper
# GPUãŒãªã„ç’°å¢ƒãªã‚‰ã€å¾Œã§ compute_type="int8" ãªã©ã«è½ã¨ã—ã¾ã™
sqlite3 ã¯æ¨™æº–ãƒ©ã‚¤ãƒ–ãƒ©ãƒªãªã®ã§è¿½åŠ ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ä¸è¦ã§ã™ã€‚

â‘¢ transcribe_local.py
ãƒ­ãƒ¼ã‚«ãƒ«éŸ³å£°ãƒ•ã‚¡ã‚¤ãƒ«ã‚’1ã¤æŒ‡å®šã—ã¦ã€

DBåˆæœŸåŒ–ï¼ˆãªã‘ã‚Œã°ä½œã‚‹ï¼‰

Whisperã§æ–‡å­—èµ·ã“ã—

ç›¸æ§Œã£ã½ã„çŸ­æ–‡ã‚’å‰Šé™¤

DBã«ä¿å­˜

ã¾ã§ã‚’ã‚„ã‚‹ã‚¹ã‚¯ãƒªãƒ—ãƒˆã§ã™ã€‚

# transcribe_local.py
import os
import sqlite3
import argparse
import re
from datetime import datetime

from faster_whisper import WhisperModel

DB_PATH = os.path.join("db", "logs.db")

# ==== ç›¸æ§Œåˆ¤å®š ====

AIZUCHI_PATTERNS = [
    r"^ã†ã‚“[ã€‚â€¦]*$",
    r"^ã¯ã„[ã€‚â€¦]*$",
    r"^ãˆãƒ¼ã¨[ã€‚â€¦]*$",
    r"^ã‚ãƒ¼[ã€‚â€¦]*$",
    r"^ãã†ã§ã™ã­[ã€‚â€¦]*$",
    r"^ãªã‚‹ã»ã©[ã€‚â€¦]*$",
    r"^ãˆãˆ[ã€‚â€¦]*$",
]

aizuchi_regex = re.compile("|".join(AIZUCHI_PATTERNS))


def is_aizuchi(text: str) -> bool:
    """çŸ­ã„ç›¸æ§Œã ã‘ã‚’æ©Ÿæ¢°çš„ã«å‰Šé™¤ã™ã‚‹"""
    t = text.strip()
    if len(t) > 15:  # 15æ–‡å­—è¶…ãˆãŸã‚‰ç›¸æ§Œã¨ã¯ã¿ãªã•ãªã„
        return False
    return bool(aizuchi_regex.match(t))


# ==== DB åˆæœŸåŒ– ====

def init_db():
    os.makedirs("db", exist_ok=True)
    conn = sqlite3.connect(DB_PATH)
    cur = conn.cursor()

    cur.execute(
        """
        CREATE TABLE IF NOT EXISTS meetings (
          id TEXT PRIMARY KEY,
          title TEXT,
          source_file TEXT,
          created_at TEXT
        );
        """
    )

    cur.execute(
        """
        CREATE TABLE IF NOT EXISTS utterances (
          id INTEGER PRIMARY KEY AUTOINCREMENT,
          meeting_id TEXT NOT NULL,
          speaker_id TEXT NOT NULL,
          started_at REAL NOT NULL,
          text TEXT NOT NULL
        );
        """
    )

    conn.commit()
    conn.close()


# ==== æ–‡å­—èµ·ã“ã—å‡¦ç† ====

def transcribe_to_db(
    audio_path: str,
    meeting_id: str,
    speaker_id: str,
    model_name: str = "large-v3",
):
    """
    audio_path: æ–‡å­—èµ·ã“ã—ã™ã‚‹éŸ³å£°ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆwavæ¨å¥¨ï¼‰
    meeting_id: ä¼šè­°IDï¼ˆä»»æ„ã®æ–‡å­—åˆ—ï¼‰
    speaker_id: è©±è€…IDï¼ˆãƒ­ãƒ¼ã‚«ãƒ«æ¤œè¨¼ãªã®ã§å›ºå®šã§ã‚‚OKï¼‰
    """

    # ãƒ¢ãƒ‡ãƒ«èª­ã¿è¾¼ã¿
    # GPUãŒãªã„ or é‡ã„å ´åˆã¯ device="cpu", compute_type="int8" ãªã©ã«å¤‰æ›´
    model = WhisperModel(model_name, device="cuda", compute_type="float16")

    conn = sqlite3.connect(DB_PATH)
    cur = conn.cursor()

    # meetings ãƒ†ãƒ¼ãƒ–ãƒ«ã«ç™»éŒ²ï¼ˆã™ã§ã«ã‚ã‚Œã°ä¸Šæ›¸ãã—ãªã„ç°¡æ˜“å®Ÿè£…ï¼‰
    cur.execute(
        """
        INSERT OR IGNORE INTO meetings (id, title, source_file, created_at)
        VALUES (?, ?, ?, ?)
        """,
        (
            meeting_id,
            f"Local test: {os.path.basename(audio_path)}",
            audio_path,
            datetime.utcnow().isoformat(),
        ),
    )
    conn.commit()

    # æ–‡å­—èµ·ã“ã—
    print(f"[INFO] Transcribing {audio_path} ...")

    segments, info = model.transcribe(
        audio_path,
        language="ja",  # æ—¥æœ¬èªå‰æ
        vad_filter=True,
    )

    inserted = 0
    for seg in segments:
        text = seg.text.strip()
        if not text:
            continue
        if is_aizuchi(text):
            # ç›¸æ§Œã¯ã‚¹ã‚­ãƒƒãƒ—
            continue

        cur.execute(
            """
            INSERT INTO utterances (meeting_id, speaker_id, started_at, text)
            VALUES (?, ?, ?, ?)
            """,
            (meeting_id, speaker_id, float(seg.start), text),
        )
        inserted += 1

    conn.commit()
    conn.close()

    print(f"[INFO] Done. Inserted {inserted} utterances into DB.")


# ==== CLI ã‚¨ãƒ³ãƒˆãƒªãƒã‚¤ãƒ³ãƒˆ ====

def main():
    parser = argparse.ArgumentParser(description="Transcribe local audio into DB.")
    parser.add_argument("audio", help="Path to audio file (e.g. recordings/sample1.wav)")
    parser.add_argument(
        "--meeting-id",
        default=None,
        help="ID for this meeting/log (default: filenameãƒ™ãƒ¼ã‚¹)",
    )
    parser.add_argument(
        "--speaker-id",
        default="local",
        help="speaker_id ã¨ã—ã¦è¨˜éŒ²ã™ã‚‹IDï¼ˆDiscordå°å…¥å¾Œã¨åˆã‚ã›ãŸã„å ´åˆã«æŒ‡å®šï¼‰",
    )
    parser.add_argument(
        "--model",
        default="large-v3",
        help="Whisper model name (e.g. large-v3, medium, small)",
    )

    args = parser.parse_args()

    audio_path = args.audio
    if not os.path.exists(audio_path):
        raise FileNotFoundError(audio_path)

    meeting_id = args.meeting_id or os.path.splitext(os.path.basename(audio_path))[0]

    init_db()
    transcribe_to_db(audio_path, meeting_id, args.speaker_id, args.model)


if __name__ == "__main__":
    main()
ä½¿ã„æ–¹ä¾‹
# ä¾‹ï¼š recordings/sample1.wav ã‚’ã€Œsample1ã€ã¨ã„ã†meeting_idã§ç™»éŒ²
python transcribe_local.py recordings/sample1.wav

# ãƒ¢ãƒ‡ãƒ«ã‚’å°‘ã—è»½ãã—ãŸã„å ´åˆ
python transcribe_local.py recordings/sample1.wav --model medium
â‘£ search_cli.pyï¼ˆå…¨æ–‡æ¤œç´¢ï¼‰
DB ã«æºœã‚ãŸ utterances ã‚’ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã§æ¤œç´¢ã™ã‚‹ã ã‘ã®ã‚·ãƒ³ãƒ—ãƒ«CLIã§ã™ã€‚

# search_cli.py
import os
import sqlite3
import argparse

DB_PATH = os.path.join("db", "logs.db")


def search(keyword: str, speaker_id: str | None = None):
    conn = sqlite3.connect(DB_PATH)
    cur = conn.cursor()

    sql = """
    SELECT meeting_id, speaker_id, started_at, text
    FROM utterances
    WHERE text LIKE ?
    """
    params = [f"%{keyword}%"]

    if speaker_id:
        sql += " AND speaker_id = ?"
        params.append(speaker_id)

    sql += " ORDER BY meeting_id, started_at"

    for row in cur.execute(sql, params):
        meeting_id, speaker, started_at, text = row
        print(f"[{meeting_id}][{speaker}][{started_at:6.1f}s] {text}")

    conn.close()


def main():
    parser = argparse.ArgumentParser(description="Search utterances in DB.")
    parser.add_argument("keyword", help="æ¤œç´¢ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰")
    parser.add_argument(
        "--speaker-id",
        default=None,
        help="ç‰¹å®šã®speaker_idã«çµã‚Šè¾¼ã‚€å ´åˆã«æŒ‡å®šï¼ˆä»»æ„ï¼‰",
    )
    args = parser.parse_args()

    if not os.path.exists(DB_PATH):
        print("DBãŒå­˜åœ¨ã—ã¾ã›ã‚“ã€‚å…ˆã« transcribe_local.py ã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„ã€‚")
        return

    search(args.keyword, args.speaker_id)


if __name__ == "__main__":
    main()
ä½¿ã„æ–¹ä¾‹
# ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã ã‘ã§æ¤œç´¢
python search_cli.py DAO

# è©±è€…IDã§çµã‚Šè¾¼ã‚€ï¼ˆå°†æ¥Discordå°å…¥å¾Œï¼‰
python search_cli.py KIBOTCHA --speaker-id sawa
â‘¤ ã¾ãšã“ã“ã¾ã§è©¦ã—ã¦ã»ã—ã„ã“ã¨
æ‰‹å…ƒã§

1äººã§ã—ã‚ƒã¹ã£ãŸéŸ³å£°

2ã€œ3äººã®ä¼šè©±ã‚’éŒ²éŸ³ã—ãŸéŸ³å£°
ã‚’ .wav ã§ç”¨æ„ã—ã¦ recordings/ ã«ç½®ã

transcribe_local.py ã§DBã«çªã£è¾¼ã‚€

search_cli.py ã§

DAOç”¨èª

ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå

æ°—ã«ãªã‚‹ãƒ•ãƒ¬ãƒ¼ã‚º
ã‚’æ¤œç´¢ã—ã¦ã¿ã‚‹

ã“ã“ã§ã€

èª¤å¤‰æ›ã®å‚¾å‘ï¼ˆã©ã®å˜èªãŒæ­»ã¬ã‹ï¼‰

ç›¸æ§Œå‰Šé™¤ã®å…·åˆï¼ˆæ¶ˆãˆã™ã/æ®‹ã‚Šã™ãï¼‰

ã‚’ä¸€å›è¦‹ã¦ã‹ã‚‰ã€

ç›¸æ§Œã®ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’å¢—ã‚„ã™ã‹

ãƒ¢ãƒ‡ãƒ«ã‚µã‚¤ã‚ºã‚’èª¿æ•´ã™ã‚‹ã‹

ãã‚‚ãã‚‚ large-v3 ãŒé‡ã™ãã‚‹ã‹

ã‚’ä¸€ç·’ã«ãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚°ã—ã¦ã„ãã®ãŒè‰¯ã„ã‹ãªã¨æ€ã„ã¾ã™ã€‚

ã“ã“ã¾ã§ã®ã‚³ãƒ¼ãƒ‰ã‚’å‹•ã‹ã—ã¦ã¿ã¦ã€

ã‚¨ãƒ©ãƒ¼ãŒå‡ºãŸ

ç²¾åº¦ãŒå¾®å¦™

ç›¸æ§ŒãŒå…¨ç„¶æ¶ˆãˆãªã„ï¼é€†ã«æ¶ˆãˆã™ãã¦ã‚‹

ãªã©ã‚ã‚Œã°ã€ãã®ç—‡çŠ¶ï¼ˆãƒ­ã‚°ã‚„å‡ºåŠ›ä¾‹ï¼‰ã‚’ãã®ã¾ã¾è²¼ã£ã¦ã‚‚ã‚‰ãˆã‚Œã°ã€
æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—ã¨ã—ã¦ã€Œèª¿æ•´ãƒã‚¤ãƒ³ãƒˆã€ã‚’ä¸€ç·’ã«è©°ã‚ã¦ã„ãã¾ã—ã‚‡ã†ã€‚

ã‚ãªãŸ:
claudeã§ä½œã‚ŠãŸã„ã®ã§ã€å¼•ãç¶™ããƒ•ã‚¡ã‚¤ãƒ«ã®ä½œæˆã‚’ãŠé¡˜ã„è‡´ã—ã¾ã™ã€‚
ChatGPT:

æ€è€ƒæ™‚é–“: 15s
ä»¥ä¸‹ã€ãã®ã¾ã¾Claudeã«æ¸¡ã›ã‚‹ã€Œå¼•ãç¶™ããƒ•ã‚¡ã‚¤ãƒ«ã€ã§ã™ã€‚
å†’é ­ã®ã‚¿ã‚¤ãƒˆãƒ«ã ã‘å¤‰ãˆã‚Œã°ã€ãã®ã¾ã¾è²¼ã‚Šä»˜ã‘ã¦ä½¿ãˆã‚‹æƒ³å®šã§æ›¸ã„ã¦ã„ã¾ã™ã€‚

DiscordéŸ³å£°ãƒ­ã‚°æ¤œç´¢ã‚·ã‚¹ãƒ†ãƒ  å¼•ãç¶™ããƒ¡ãƒ¢ï¼ˆPythonï¼‹Whisperï¼‰
1. èƒŒæ™¯ãƒ»ç›®çš„
Discord ã® Voice Chatï¼ˆVCï¼‰ã§è¡Œã£ãŸä¼šè©±ã‚’ã€ã‚ã¨ã‹ã‚‰å…¨æ–‡æ¤œç´¢ã§ãã‚‹å½¢ã§ä¿å­˜ã—ãŸã„ã€‚

ãŸã ã—ã€

ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ å­—å¹•ã‚„ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ è­°äº‹éŒ²ã¯ä¸è¦ã€‚

è‡ªå‹•è¦ç´„ãƒ»è­°äº‹éŒ²åŒ–ã‚‚ä¸è¦ã€‚

å¿…è¦ãªã®ã¯ ã€Œèª°ãŒãƒ»ã„ã¤ãƒ»ä½•ã‚’è©±ã—ãŸã‹ã€ ã‚’ãƒ†ã‚­ã‚¹ãƒˆã§è“„ç©ã—ã€ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰æ¤œç´¢ã§ãã‚‹ã“ã¨ã€‚

ã€Œã†ã‚“ã€ã€Œã¯ã„ã€ãªã©ã®ç›¸æ§Œç³»ã¯ã€ãƒ†ã‚­ã‚¹ãƒˆä¿å­˜æ™‚ã«å‰Šé™¤ã—ã¦ã‚ˆã„ã€‚

å°†æ¥çš„ã«ã¯ Discord Bot ãŒ VC ã‚’éŒ²éŸ³ â†’ Whisper ã§æ–‡å­—èµ·ã“ã— â†’ DB ã«ä¿å­˜ â†’ /search ã‚³ãƒãƒ³ãƒ‰ã§æ¤œç´¢
ã¨ã„ã†å½¢ã‚’ç›®æŒ‡ã™ãŒã€ã¾ãšã¯ ãƒ­ãƒ¼ã‚«ãƒ«éŸ³å£°ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å¯¾è±¡ã«ã—ãŸæœ€å°æ§‹æˆ ã‹ã‚‰ä½œã£ã¦ã„ã‚‹ã€‚

ã“ã®æœ€å°æ§‹æˆï¼ˆãƒ­ãƒ¼ã‚«ãƒ«ç‰ˆï¼‰ã‚’ãƒ™ãƒ¼ã‚¹ã«ã€æœ€çµ‚çš„ã« Discord Bot ã¾ã§æ‹¡å¼µã—ã¦ã»ã—ã„ã€‚

2. å…¨ä½“ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ï¼ˆæœ€çµ‚ã‚¤ãƒ¡ãƒ¼ã‚¸ï¼‰
æœ€çµ‚çš„ã«ã‚„ã‚ŠãŸã„æ§‹æˆã¯ä»¥ä¸‹ï¼š

Recorder Botï¼ˆDiscordï¼‰

VC ã«å‚åŠ ã—ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã”ã¨ã®éŸ³å£°ã‚¹ãƒˆãƒªãƒ¼ãƒ ã‚’éŒ²éŸ³ã™ã‚‹ã€‚

meeting_id ã¨ speaker_idï¼ˆï¼Discord user_idï¼‰ ã”ã¨ã«éŸ³å£°ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆWAVãªã©ï¼‰ã‚’ä¿å­˜ã€‚

Transcriberï¼ˆãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰å‡¦ç†ï¼‰

ä¿å­˜ã•ã‚ŒãŸéŸ³å£°ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã¾ã¨ã‚ã¦å‡¦ç†ã€‚

Whisperï¼ˆlarge-v3 ç­‰ï¼‰ã§æ—¥æœ¬èªéŸ³å£°ã‚’æ–‡å­—èµ·ã“ã—ã€‚

ã€Œç›¸æ§Œç³»ã®çŸ­ã„ç™ºè©±ã€ã‚’å‰Šé™¤ã€‚

meeting_id / speaker_id / started_at / text ã®å½¢å¼ã§ DB ã«ä¿å­˜ã€‚

Search ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹

CLI ã¾ãŸã¯ Discord ã‚³ãƒãƒ³ãƒ‰ã‹ã‚‰ã€

ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã§å…¨æ–‡æ¤œç´¢

å¿…è¦ãªã‚‰è©±è€…ã‚„ meeting ã”ã¨ã«çµã‚Šè¾¼ã¿

çµæœã‚’ãƒ­ã‚°ã¨ã—ã¦è¡¨ç¤ºã™ã‚‹ï¼ˆè­°äº‹éŒ²åŒ–ã¯ã—ãªã„ï¼‰ã€‚

ç¾åœ¨ã¯ã€2ã¨3ï¼ˆãƒ­ãƒ¼ã‚«ãƒ«éŸ³å£°ç‰ˆï¼‰ ã®ãŸãŸãå°ã‚³ãƒ¼ãƒ‰ãŒã‚ã‚‹çŠ¶æ…‹ã€‚
ã“ã®ç¶šãã‚’ã€Claude ã«ä»•ä¸Šã’ã¦ã‚‚ã‚‰ã„ãŸã„ã€‚

3. ç¾çŠ¶ã®ãƒ­ãƒ¼ã‚«ãƒ«å®Ÿè£…ï¼ˆãŸãŸãå°ã‚³ãƒ¼ãƒ‰ï¼‰
3-1. ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹æˆï¼ˆæƒ³å®šï¼‰
project/
  recordings/
    sample1.wav      # ãƒ†ã‚¹ãƒˆç”¨ã®ãƒ­ãƒ¼ã‚«ãƒ«éŸ³å£°ãƒ•ã‚¡ã‚¤ãƒ«
  db/
    logs.db          # SQLite DBï¼ˆã‚¹ã‚¯ãƒªãƒ—ãƒˆãŒè‡ªå‹•ç”Ÿæˆï¼‰
  transcribe_local.py
  search_cli.py
3-2. ä½¿ç”¨ãƒ©ã‚¤ãƒ–ãƒ©ãƒªãƒ»ç’°å¢ƒ
è¨€èªï¼šPythonï¼ˆ3.10 ä»¥é™æƒ³å®šï¼‰

STTï¼šfaster-whisper

DBï¼šSQLiteï¼ˆæ¨™æº–ãƒ©ã‚¤ãƒ–ãƒ©ãƒª sqlite3ï¼‰

pip install faster-whisper
GPU ãŒã‚ã‚Œã° device="cuda", compute_type="float16" ã§å‹•ã‹ã—ãŸã„ãŒã€
CPU å‰æã§ã‚‚æ§‹ã‚ãªã„ï¼ˆãã®å ´åˆã¯ compute_type ã‚’è»½é‡åŒ–ã™ã‚‹ï¼‰ã€‚

4. DBæ§‹é€ ï¼ˆãƒ­ãƒ¼ã‚«ãƒ«ç‰ˆï¼‰
ãƒ­ãƒ¼ã‚«ãƒ«æ¤œè¨¼ç”¨ã«ã€æœ€å°é™ã®2ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’å®šç¾©ã—ã¦ã„ã‚‹ã€‚

4-1. meetings ãƒ†ãƒ¼ãƒ–ãƒ«
CREATE TABLE meetings (
  id TEXT PRIMARY KEY,        -- meeting_idï¼ˆæ–‡å­—åˆ—ï¼‰
  title TEXT,                 -- ä»»æ„ã‚¿ã‚¤ãƒˆãƒ«ï¼ˆä¾‹ï¼šãƒ•ã‚¡ã‚¤ãƒ«åï¼‰
  source_file TEXT,           -- å…ƒã®éŸ³å£°ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹
  created_at TEXT             -- ISO8601 UTC
);
4-2. utterances ãƒ†ãƒ¼ãƒ–ãƒ«
CREATE TABLE utterances (
  id INTEGER PRIMARY KEY AUTOINCREMENT,
  meeting_id TEXT NOT NULL,   -- meetings.id ã¸ã®å¤–éƒ¨ã‚­ãƒ¼
  speaker_id TEXT NOT NULL,   -- ä»Šã¯ "local" å›ºå®šã€‚å°†æ¥ã¯ Discord user_id
  started_at REAL NOT NULL,   -- éŸ³å£°ãƒ•ã‚¡ã‚¤ãƒ«å†…ã§ã®é–‹å§‹ç§’æ•°
  text TEXT NOT NULL          -- æ–‡å­—èµ·ã“ã—çµæœï¼ˆç›¸æ§Œã¯å‰Šé™¤æ¸ˆã¿ï¼‰
);
é‡è¦ãªåˆ¶ç´„

æ—¥æœ¬èªå‰æã€‚

ç›¸æ§Œã®ã‚ˆã†ãªã€å˜ç‹¬ã®çŸ­ã„æ„Ÿå‹•è©ã®ã¿ã®ç™ºè©±ã¯ã€DBä¿å­˜å‰ã«å‰Šé™¤ã™ã‚‹ã€‚

5. transcribe_local.pyï¼ˆãŸãŸãå°ï¼‰
ãƒ­ãƒ¼ã‚«ãƒ«ã® .wav ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ–‡å­—èµ·ã“ã—ã—ã¦ DB ã«ä¿å­˜ã™ã‚‹ã‚¹ã‚¯ãƒªãƒ—ãƒˆã€‚
ç›¸æ§Œå‰Šé™¤ãƒ­ã‚¸ãƒƒã‚¯ã‚‚å«ã‚ã¦ã‚ã‚‹ã€‚

# transcribe_local.py
import os
import sqlite3
import argparse
import re
from datetime import datetime

from faster_whisper import WhisperModel

DB_PATH = os.path.join("db", "logs.db")

# ==== ç›¸æ§Œåˆ¤å®š ====

AIZUCHI_PATTERNS = [
    r"^ã†ã‚“[ã€‚â€¦]*$",
    r"^ã¯ã„[ã€‚â€¦]*$",
    r"^ãˆãƒ¼ã¨[ã€‚â€¦]*$",
    r"^ã‚ãƒ¼[ã€‚â€¦]*$",
    r"^ãã†ã§ã™ã­[ã€‚â€¦]*$",
    r"^ãªã‚‹ã»ã©[ã€‚â€¦]*$",
    r"^ãˆãˆ[ã€‚â€¦]*$",
]

aizuchi_regex = re.compile("|".join(AIZUCHI_PATTERNS))


def is_aizuchi(text: str) -> bool:
    """çŸ­ã„ç›¸æ§Œã ã‘ã‚’æ©Ÿæ¢°çš„ã«å‰Šé™¤ã™ã‚‹"""
    t = text.strip()
    if len(t) > 15:  # 15æ–‡å­—è¶…ãˆãŸã‚‰ç›¸æ§Œã¨ã¯ã¿ãªã•ãªã„
        return False
    return bool(aizuchi_regex.match(t))


# ==== DB åˆæœŸåŒ– ====

def init_db():
    os.makedirs("db", exist_ok=True)
    conn = sqlite3.connect(DB_PATH)
    cur = conn.cursor()

    cur.execute(
        """
        CREATE TABLE IF NOT EXISTS meetings (
          id TEXT PRIMARY KEY,
          title TEXT,
          source_file TEXT,
          created_at TEXT
        );
        """
    )

    cur.execute(
        """
        CREATE TABLE IF NOT EXISTS utterances (
          id INTEGER PRIMARY KEY AUTOINCREMENT,
          meeting_id TEXT NOT NULL,
          speaker_id TEXT NOT NULL,
          started_at REAL NOT NULL,
          text TEXT NOT NULL
        );
        """
    )

    conn.commit()
    conn.close()


# ==== æ–‡å­—èµ·ã“ã—å‡¦ç† ====

def transcribe_to_db(
    audio_path: str,
    meeting_id: str,
    speaker_id: str,
    model_name: str = "large-v3",
):
    """
    audio_path: æ–‡å­—èµ·ã“ã—ã™ã‚‹éŸ³å£°ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆwavæ¨å¥¨ï¼‰
    meeting_id: ä¼šè­°IDï¼ˆä»»æ„ã®æ–‡å­—åˆ—ï¼‰
    speaker_id: è©±è€…IDï¼ˆãƒ­ãƒ¼ã‚«ãƒ«æ¤œè¨¼ãªã®ã§å›ºå®šã§ã‚‚OKï¼‰
    """

    # ãƒ¢ãƒ‡ãƒ«èª­ã¿è¾¼ã¿
    # GPUãŒãªã„ / é‡ã„å ´åˆã¯ device="cpu", compute_type="int8" ãªã©ã«èª¿æ•´ã—ã¦ã»ã—ã„
    model = WhisperModel(model_name, device="cuda", compute_type="float16")

    conn = sqlite3.connect(DB_PATH)
    cur = conn.cursor()

    # meetings ãƒ†ãƒ¼ãƒ–ãƒ«ã«ç™»éŒ²ï¼ˆã™ã§ã«ã‚ã‚Œã°ä¸Šæ›¸ãã—ãªã„ç°¡æ˜“å®Ÿè£…ï¼‰
    cur.execute(
        """
        INSERT OR IGNORE INTO meetings (id, title, source_file, created_at)
        VALUES (?, ?, ?, ?)
        """,
        (
            meeting_id,
            f"Local test: {os.path.basename(audio_path)}",
            audio_path,
            datetime.utcnow().isoformat(),
        ),
    )
    conn.commit()

    # æ–‡å­—èµ·ã“ã—
    print(f"[INFO] Transcribing {audio_path} ...")

    segments, info = model.transcribe(
        audio_path,
        language="ja",  # æ—¥æœ¬èªå‰æ
        vad_filter=True,
    )

    inserted = 0
    for seg in segments:
        text = seg.text.strip()
        if not text:
            continue
        if is_aizuchi(text):
            # ç›¸æ§Œã¯ã‚¹ã‚­ãƒƒãƒ—
            continue

        cur.execute(
            """
            INSERT INTO utterances (meeting_id, speaker_id, started_at, text)
            VALUES (?, ?, ?, ?)
            """,
            (meeting_id, speaker_id, float(seg.start), text),
        )
        inserted += 1

    conn.commit()
    conn.close()

    print(f"[INFO] Done. Inserted {inserted} utterances into DB.")


# ==== CLI ã‚¨ãƒ³ãƒˆãƒªãƒã‚¤ãƒ³ãƒˆ ====

def main():
    parser = argparse.ArgumentParser(description="Transcribe local audio into DB.")
    parser.add_argument("audio", help="Path to audio file (e.g. recordings/sample1.wav)")
    parser.add_argument(
        "--meeting-id",
        default=None,
        help="ID for this meeting/log (default: filenameãƒ™ãƒ¼ã‚¹)",
    )
    parser.add_argument(
        "--speaker-id",
        default="local",
        help="speaker_id ã¨ã—ã¦è¨˜éŒ²ã™ã‚‹IDï¼ˆDiscordå°å…¥å¾Œã¨åˆã‚ã›ãŸã„å ´åˆã«æŒ‡å®šï¼‰",
    )
    parser.add_argument(
        "--model",
        default="large-v3",
        help="Whisper model name (e.g. large-v3, medium, small)",
    )

    args = parser.parse_args()

    audio_path = args.audio
    if not os.path.exists(audio_path):
        raise FileNotFoundError(audio_path)

    meeting_id = args.meeting_id or os.path.splitext(os.path.basename(audio_path))[0]

    init_db()
    transcribe_to_db(audio_path, meeting_id, args.speaker_id, args.model)


if __name__ == "__main__":
    main()
ä½¿ã„æ–¹ï¼ˆãƒ­ãƒ¼ã‚«ãƒ«ï¼‰
# ä¾‹ï¼š recordings/sample1.wav ã‚’ã€Œsample1ã€ã¨ã„ã† meeting_id ã¨ã—ã¦DBã«ç™»éŒ²
python transcribe_local.py recordings/sample1.wav

# ãƒ¢ãƒ‡ãƒ«ã‚µã‚¤ã‚ºã‚’å¤‰ãˆãŸã„å ´åˆ
python transcribe_local.py recordings/sample1.wav --model medium
6. search_cli.pyï¼ˆæ¤œç´¢ç”¨ãŸãŸãå°ï¼‰
DB ã«ä¿å­˜ã•ã‚ŒãŸ utterances ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’ã€ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã§å…¨æ–‡æ¤œç´¢ã™ã‚‹ç°¡æ˜“ CLIã€‚

# search_cli.py
import os
import sqlite3
import argparse

DB_PATH = os.path.join("db", "logs.db")


def search(keyword: str, speaker_id: str | None = None):
    conn = sqlite3.connect(DB_PATH)
    cur = conn.cursor()

    sql = """
    SELECT meeting_id, speaker_id, started_at, text
    FROM utterances
    WHERE text LIKE ?
    """
    params = [f"%{keyword}%"]

    if speaker_id:
        sql += " AND speaker_id = ?"
        params.append(speaker_id)

    sql += " ORDER BY meeting_id, started_at"

    for row in cur.execute(sql, params):
        meeting_id, speaker, started_at, text = row
        print(f"[{meeting_id}][{speaker}][{started_at:6.1f}s] {text}")

    conn.close()


def main():
    parser = argparse.ArgumentParser(description="Search utterances in DB.")
    parser.add_argument("keyword", help="æ¤œç´¢ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰")
    parser.add_argument(
        "--speaker-id",
        default=None,
        help="ç‰¹å®šã®speaker_idã«çµã‚Šè¾¼ã‚€å ´åˆã«æŒ‡å®šï¼ˆä»»æ„ï¼‰",
    )
    args = parser.parse_args()

    if not os.path.exists(DB_PATH):
        print("DBãŒå­˜åœ¨ã—ã¾ã›ã‚“ã€‚å…ˆã« transcribe_local.py ã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„ã€‚")
        return

    search(args.keyword, args.speaker_id)


if __name__ == "__main__":
    main()
ä½¿ã„æ–¹ä¾‹
# ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã ã‘ã§å…¨æ–‡æ¤œç´¢
python search_cli.py DAO

# è©±è€…IDã§çµã‚Šè¾¼ã‚€ï¼ˆå°†æ¥ Discord user_id ã‚’å…¥ã‚Œã‚‹æƒ³å®šï¼‰
python search_cli.py KIBOTCHA --speaker-id local
7. Claude ã«ãŠé¡˜ã„ã—ãŸã„ã“ã¨
ã“ã“ã‹ã‚‰å…ˆã‚’ã€Claude ã«ãŠé¡˜ã„ã—ãŸã„å†…å®¹ã‚’æ•´ç†ã—ã¾ã™ã€‚

7-1. ãƒ­ãƒ¼ã‚«ãƒ«ç‰ˆã®ãƒ–ãƒ©ãƒƒã‚·ãƒ¥ã‚¢ãƒƒãƒ—
Whisper ã®ãƒ¢ãƒ‡ãƒ«ãƒ­ãƒ¼ãƒ‰éƒ¨åˆ†ã®æ•´ç†

æ¯å› transcribe_to_db ã®ä¸­ã§ãƒ¢ãƒ‡ãƒ«ã‚’ãƒ­ãƒ¼ãƒ‰ã—ã¦ã„ã‚‹ãŒã€

ç¹°ã‚Šè¿”ã—ä½¿ã†å ´åˆã¯ã€ãƒ—ãƒ­ã‚»ã‚¹èµ·å‹•æ™‚ã«ä¸€åº¦ã ã‘ãƒ­ãƒ¼ãƒ‰ã™ã‚‹å½¢ã«æ”¹å–„ã—ã¦ã»ã—ã„ã€‚

GPU/CPU ã®åˆ‡ã‚Šæ›¿ãˆã‚’ã€èµ·å‹•ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‹è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã§åˆ¶å¾¡ã§ãã‚‹ã‚ˆã†ã«ã—ã¦ã»ã—ã„ã€‚

ç›¸æ§Œåˆ¤å®šãƒ­ã‚¸ãƒƒã‚¯ã®èª¿æ•´

ç¾çŠ¶ã¯å˜ç´”ãªãƒ«ãƒ¼ãƒ«ãƒ™ãƒ¼ã‚¹ã€‚

ãƒ†ã‚¹ãƒˆéŸ³å£°ã‚’æŠ•å…¥ã—ã¤ã¤ã€

æ¶ˆã—ãŸã„ç›¸æ§ŒãŒæ®‹ã£ã¦ã„ã‚‹ï¼é€†ã«æ¶ˆãˆãªãã¦ã„ã„æ–‡ãŒæ¶ˆãˆã¦ã„ã‚‹

ã¨ã„ã£ãŸå•é¡ŒãŒã‚ã‚Œã°ã€ãƒ‘ã‚¿ãƒ¼ãƒ³ã®èª¿æ•´ã‚„æ”¹å–„æ¡ˆã‚’ææ¡ˆãƒ»å®Ÿè£…ã—ã¦ã»ã—ã„ã€‚

ã‚¨ãƒ©ãƒ¼å‡¦ç†ãƒ»ãƒ­ã‚°å‡ºåŠ›

ãƒ•ã‚¡ã‚¤ãƒ«ãŒå£Šã‚Œã¦ã„ã‚‹å ´åˆã‚„ STT ã«å¤±æ•—ã—ãŸå ´åˆã®ä¾‹å¤–å‡¦ç†ã‚’æ•´å‚™ã€‚

ãƒ­ã‚°å‡ºåŠ›ï¼ˆæ¨™æº–å‡ºåŠ› or ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«ï¼‰ã‚’æœ€ä½é™æ•´ãˆã¦ã»ã—ã„ã€‚

7-2. Discord Bot ã¸ã®æ‹¡å¼µï¼ˆRecorder Botï¼‰
ã‚´ãƒ¼ãƒ«ï¼šDiscord VC ã®éŸ³å£°ã‚’ã€ç¾çŠ¶ã® DB æ§‹é€ ã«åˆã†å½¢ã§ä¿å­˜ã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹ã€‚

å…·ä½“çš„ã«ã‚„ã‚ŠãŸã„ã“ã¨ï¼š

ä½¿ç”¨ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®é¸å®š

Python ã® Discord ãƒ©ã‚¤ãƒ–ãƒ©ãƒªï¼ˆdiscord.py ã®å¾Œç¶™ãƒ•ã‚©ãƒ¼ã‚¯ãªã©ï¼‰ã§ã€

Voice Receiveï¼ˆVC ã®éŸ³å£°å—ä¿¡ï¼‰

ãƒ¦ãƒ¼ã‚¶ãƒ¼ã”ã¨ã®éŸ³å£°ã‚¹ãƒˆãƒªãƒ¼ãƒ å–å¾—

ãŒã—ã‚„ã™ã„ã‚‚ã®ã‚’é¸ã³ã€requirements.txt ã¨ã¨ã‚‚ã«ææ¡ˆã—ã¦ã»ã—ã„ã€‚

éŒ²éŸ³ã‚»ãƒƒã‚·ãƒ§ãƒ³ç®¡ç†

!record ã‚³ãƒãƒ³ãƒ‰ã§éŒ²éŸ³é–‹å§‹

Bot ãŒã€ã‚³ãƒãƒ³ãƒ‰é€ä¿¡è€…ã®ã„ã‚‹ VC ã«å‚åŠ ã€‚

MeetingSession çš„ãªã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆã—ã€meeting_id ã‚’ç™ºè¡Œã€‚

!stop ã‚³ãƒãƒ³ãƒ‰ã§éŒ²éŸ³çµ‚äº†

éŸ³å£°å—ä¿¡ã‚’åœæ­¢ã€‚

å„ãƒ¦ãƒ¼ã‚¶ãƒ¼ã”ã¨ã® PCM ãƒãƒƒãƒ•ã‚¡ã‚’ recordings/{meeting_id}_{user_id}.wav ã®ã‚ˆã†ãªå½¢å¼ã§ä¿å­˜ã€‚

meetings ãƒ†ãƒ¼ãƒ–ãƒ«ã«ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ã‚’ä¿å­˜ï¼ˆDiscord guild / channel ãªã©ã®æƒ…å ±ã‚‚å…¥ã‚Œã‚‰ã‚Œã‚‹ã¨ãªãŠè‰¯ã„ï¼‰ã€‚

éŸ³å£°å—ä¿¡ãƒ­ã‚¸ãƒƒã‚¯ï¼ˆAudioSink å®Ÿè£…ï¼‰

Discord ã® Voice API ã§ãƒ¦ãƒ¼ã‚¶ãƒ¼ã”ã¨ã® Opus ã‚¹ãƒˆãƒªãƒ¼ãƒ ã‚’å—ä¿¡ã—ã€PCM ã«ãƒ‡ã‚³ãƒ¼ãƒ‰ã€‚

MeetingSession ãŒæŒã¤ user_buffers[user_id] ã« PCM ã‚’ append ã—ã¦ã„ãå½¢ã€‚

æ—¢ã«ã‚ã‚‹ save_pcm_to_wav() ã®ã‚ˆã†ãªå®Ÿè£…ã‚’ãƒ™ãƒ¼ã‚¹ã«ã€WAV ãƒ•ã‚¡ã‚¤ãƒ«ã«å¤‰æ›ã—ã¦ä¿å­˜ã€‚

Transcriber ã¨ã®é€£æº

éŒ²éŸ³çµ‚äº†å¾Œã«ã€

æ‰‹å‹•ã§ transcribe_local.py ã‚’å‘¼ã³å‡ºã™

ã¾ãŸã¯ Bot å´ã‹ã‚‰ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰ã§ STT å‡¦ç†ã‚’ã‚­ãƒƒã‚¯ã™ã‚‹

ã©ã¡ã‚‰ã‹ã®æ–¹å¼ã§ã€Discord ã‹ã‚‰ã®éŒ²éŸ³ãƒ•ã‚¡ã‚¤ãƒ«ã‚‚æ—¢å­˜ã®ãƒ­ãƒ¼ã‚«ãƒ«ã¨åŒã˜ãƒ•ãƒ­ãƒ¼ã§ DB ã«å…¥ã‚‹ã‚ˆã†ã«ã™ã‚‹ã€‚

/search ã‚³ãƒãƒ³ãƒ‰ï¼ˆä½™è£•ãŒã‚ã‚Œã°ï¼‰

Discord ä¸Šã§ã€

/search keyword:<string> [user:@mention] [meeting_id:<id>]

ã®ã‚ˆã†ãª Slash Command ã‚’ç”¨æ„ã—ã€search_cli.py ç›¸å½“ã®æ¤œç´¢çµæœã‚’ Embed ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ç­‰ã§è¿”ã™ã€‚

8. å„ªå…ˆé †ä½
ãƒ­ãƒ¼ã‚«ãƒ«ç‰ˆï¼ˆtranscribe_local.py / search_cli.pyï¼‰ã®å®‰å®šåŒ–ãƒ»æ•´ç†

Whisper ãƒ¢ãƒ‡ãƒ«ãƒ­ãƒ¼ãƒ‰ã®æœ€é©åŒ–

ç›¸æ§Œå‰Šé™¤ãƒ­ã‚¸ãƒƒã‚¯ã®ãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚°

ã‚¨ãƒ©ãƒ¼å‡¦ç†ãƒ»ãƒ­ã‚°

Discord Recorder Bot ã®å®Ÿè£…

éŸ³å£°å—ä¿¡ï¼‹ãƒ¦ãƒ¼ã‚¶ãƒ¼ã”ã¨ã®éŒ²éŸ³

WAV ä¿å­˜

meetings ãƒ†ãƒ¼ãƒ–ãƒ«ã¨ã®é€£æº

Discord ã‹ã‚‰ã®æ¤œç´¢ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ï¼ˆä½™è£•ãŒã‚ã‚Œã°ï¼‰

Slash Command çµŒç”±ã§ã®æ¤œç´¢

çµæœã®æ•´å½¢è¡¨ç¤º

9. è£œè¶³
å¯¾è±¡è¨€èªã¯åŸºæœ¬çš„ã«æ—¥æœ¬èªã€‚

ãƒ¢ãƒ‡ãƒ«ã¯ large-v3 ã‚’æƒ³å®šã—ã¦ã„ã‚‹ãŒã€

ã‚³ã‚¹ãƒˆã‚„ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã®è¦³ç‚¹ã‹ã‚‰ medium ãªã©ã‚’å«ã‚ã€Claudeå´ã§ã‚‚é©åˆ‡ãªé¸æŠè‚¢ã‚’ææ¡ˆã—ã¦ã»ã—ã„ã€‚

å°†æ¥çš„ã«ã¯

speaker_id ã« Discord user_id ã‚’ãã®ã¾ã¾å…¥ã‚Œã‚‹

meetings ã« guild_id / channel_id / started_at / ended_at ã‚’æ‹¡å¼µã™ã‚‹

ãªã©ã®æ‹¡å¼µã‚‚è¦–é‡ã«å…¥ã‚Œã¦ã„ã‚‹ãŒã€ã¾ãšã¯ä¸Šè¨˜ã®å„ªå…ˆé †ä½ã§é€²ã‚ãŸã„ã€‚

ä»¥ä¸Šã‚’ãã®ã¾ã¾ Claude ã«æ¸¡ã—ã¦ã‚‚ã‚‰ãˆã‚Œã°ã€
ã€Œãƒ­ãƒ¼ã‚«ãƒ« STT â†’ Discord Botã€ã¾ã§ã‚¹ãƒ ãƒ¼ã‚ºã«å¼•ãç¶™ã’ã‚‹ã¯ãšã§ã™ã€‚




é¸æŠã•ã‚Œã¦ã„ã¾ã›ã‚“é¸æŠã•ã‚Œã¦ã„ã¾ã›ã‚“
ChatGPT ã®å›ç­”ã¯å¿…ãšã—ã‚‚æ­£ã—ã„ã¨ã¯é™ã‚Šã¾ã›ã‚“ã€‚é‡è¦ãªæƒ…å ±ã¯ç¢ºèªã™ã‚‹ã‚ˆã†ã«ã—ã¦ãã ã•ã„ã€‚cookie ã®è¨­å®šã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚
